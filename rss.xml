<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>JustCloud Blog Blog</title>
        <link>https://blog.justcloud.pl/</link>
        <description>JustCloud Blog Blog</description>
        <lastBuildDate>Sat, 22 Jan 2022 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <item>
            <title><![CDATA[Nowa odsÅ‚ona]]></title>
            <link>https://blog.justcloud.pl/welcome</link>
            <guid>welcome</guid>
            <pubDate>Sat, 22 Jan 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Nowy rok 2022 bÄ™dzie czasem zmian dla moich aktywnoÅ›ci w Internecie. Rozpoczynam od zmian zwiÄ…zanych z blogiem i aktywnoÅ›ciami IT w community.]]></description>
            <content:encoded><![CDATA[<p>Witam na nowej stronie gdziÄ™ bÄ™dÄ™ wrzucaÅ‚ nowe posty zwiÄ…zane z Microsoft Azure oraz Cloudâ˜ï¸. Nowy rok 2022 mam nadziejÄ™ Å¼e przyniesie wiele pozytywnych zmian. Dlatego zapraszam do kontaktu i odwiedzin mojej strony.</p><p>Nowe linki i maÅ‚e zmiany:</p><ul><li><a href="https://web.justcloud.pl" target="_blank" rel="noopener noreferrer">JustCloud â˜ï¸ Page</a></li><li><a href="https://blog.justcloud.pl" target="_blank" rel="noopener noreferrer">JustCloud â˜ï¸ Blog</a></li></ul><p>W najbliÅ¼szym czasie&nbsp;ogarnÄ™&nbsp;rÃ³wnieÅ¼ uzupeÅ‚nienie bloga o stare posty ğŸ™ƒ.</p><p>DziÄ™ki i do zobaczenia!</p><p><img src="https://images.unsplash.com/photo-1472898965229-f9b06b9c9bbe?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=2070&amp;q=80" alt="welcome"></p>]]></content:encoded>
            <category>welcome</category>
            <category>first post</category>
            <category>blog</category>
        </item>
        <item>
            <title><![CDATA[Przyspieszenie pracy nad tagowaniem zasobÃ³w za pomocÄ… PowerShell - Tag raport Microsoft Azure]]></title>
            <link>https://blog.justcloud.pl/tags-in-azure</link>
            <guid>tags-in-azure</guid>
            <pubDate>Thu, 03 Jun 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Zastanawiasz siÄ™ jak tagowaÄ‡ zasoby w Azure? W tym artykule dokÅ‚adnie opisuje jak to zrobiÄ‡ dla maÅ‚ych i duÅ¼ych Å›rodowisk w Auzre.]]></description>
            <content:encoded><![CDATA[<p>KiedyÅ› przygotowaÅ‚em ten skrypt Å¼eby szybko mÃ³c otagowaÄ‡ wiele zasobÃ³w wdroÅ¼onych na platformie Microsoft Azure. Jest wiele moÅ¼liwoÅ›ci jak to zrobiÄ‡ szybko, prosto, ale staraÅ‚em siÄ™ zrobiÄ‡ uniwersalne rozwiÄ…zanie bÄ™dÄ…ce Å‚atwe oraz bezpieczne w uÅ¼yciu. Dlatego postanowiÅ‚em zrobiÄ‡ jeden skrypt, ktÃ³ry generuje nam wszystkie zasoby do pliku CSV. A drugi skrypt na podstawie pliku CSV bÄ™dzie pobieraÅ‚ z niego dane zasobÃ³w i nadpisywaÅ‚ je na platformie.</p><p>Skrypty sÄ… dostÄ™pne na GitHub:</p><ul><li><a href="https://github.com/RogalaPiotr/JustCloudPublic/tree/master/azure-tags-report" target="_blank" rel="noopener noreferrer">https://github.com/RogalaPiotr/JustCloudPublic/tree/master/azure-tags-report</a></li></ul><p>Opis skryptÃ³w:</p><ul><li>GetAllTags.ps1- generuje dwa pliki CSV. Jeden plik dla Resource Group, a drugi plik dla Resources. Jest to istotne poniewaÅ¼ mamy oddzielone grupy i moÅ¼emy inaczej tagowaÄ‡ grupy od zasobÃ³w bez szukania typÃ³w zasobÃ³w.</li><li>SetTagsResourceGroups.ps1 - skrypt, ktÃ³ry pobiera dane z pliku CSV gdzie jest spis Resource Group z tagami do wdroÅ¼enia.</li><li>SetTagsResources.ps1- skrypt, ktÃ³ry pobiera dane z pliku CSV gdzie zapisane mamy zasoby z tagami do wdroÅ¼enia.</li></ul><p>Taki podziaÅ‚ daje nam:</p><ol><li>Zapis stanu obecnego tagÃ³w zapisanych do pliku CSV. Jest to raport tagÃ³w czyli obecny stan wdroÅ¼ony tagÃ³w.</li><li>PodziaÅ‚ na grupy i zasoby.</li><li>MoÅ¼liwoÅ›Ä‡ poprawiania tagÃ³w tylko na zasobach lub tylko na grupach zasobÃ³w.</li></ol><p>Jak dziaÅ‚ajÄ… skrypty?</p><ol><li>GetAllTags<ol><li>Zapis do pliku odbywa siÄ™ automatycznie do lokalizacji gdzie wykonujemy skrypt lub moÅ¼emy uÅ¼yÄ‡ opcji -path gdzie majÄ… byÄ‡ zapisane pliki.</li><li>Nazwa pliku zawiera datÄ™, jeÅ›li plik istnieje zostanie on nadpisany.</li><li>Skrypt sprawdza czy jesteÅ› zalogowany do Azure. Podczas wykonywania skryptu moÅ¼esz podaÄ‡ parametr -tenantId, aby mieÄ‡&nbsp;pewnoÅ›Ä‡&nbsp;Å¼e logujesz siÄ™&nbsp;do odpowiedniego Azure Directory i -subId w celu wybrania subskrypcji.</li></ol></li><li>SetTagsResourceGroups oraz SetTagsResources<ol><li>Import danych z plikÃ³w odbywa siÄ™ automatycznie na podstawie konwencji nazewniczej wygenerowanego wczeÅ›niej pliku. Skrypt importuje najnowszy plik CSV we wskazanym katalogu. Istnieje podanie Å›cieÅ¼ki poprzez parametr -path.</li><li>Tagi powinny byÄ‡ oddzielone miÄ™dzy sobÄ… przecinkami.</li><li>Tagi zapisane w pliku CSV dziaÅ‚ajÄ… na zasadzie par â€œKey:Valueâ€ w osobnych kolumnach.</li><li>Skrypt pobiera wszystkie elementy z pliku CSV. NastÄ™pnie skrypt usuwa tagi w Microsoft Azure nastÄ™pnie wprowadzony z pliku CSV.</li><li>JeÅ›li nie chcemy danego zasobu ruszaÄ‡, wystarczy go usunÄ…Ä‡ z pliku CSV.</li><li>Skrypt dziaÅ‚a w trybie parallel co pozwala na szybsze wprowadzanie zmian. Throttle dla zapisu tagÃ³w wynosi 5, pamiÄ™taj, Å¼e jest to optymalna wartoÅ›Ä‡.</li><li>Skrypt sprawdza czy jesteÅ› zalogowany do Azure. Podczas wykonywania skryptu moÅ¼esz podaÄ‡ parametr -tenantId.</li><li>JeÅ›li chcesz wyczyÅ›ciÄ‡ tagi na zasobach wystarczy Å¼e zostawisz pustÄ… komÃ³rkÄ™&nbsp;lub wpiszesz â€œemptyâ€.</li><li>Wprowadzanie tagÃ³w moÅ¼emy testowaÄ‡&nbsp;wprowadzajÄ…c w pliku CSV tylko ten zasÃ³b ktÃ³ry chcemy zmieniÄ‡. Reszta zasobÃ³w nie bÄ™dzie brana pod uwagÄ™&nbsp;podczas wdraÅ¼ania tagÃ³w.</li></ol></li></ol><p>PoniÅ¼ej przedstawiam przykÅ‚ad jak to dziaÅ‚a na mojej subskrypcji.</p><p>Uruchomienie skryptu:</p><ul><li>GetAllTags.ps1</li></ul><p><code>Komenda: ./GetAllTags.ps1 -path /tags</code></p><p><img src="https://lh6.googleusercontent.com/g2uknxvVr-r8zuu_JNgHwzMEWXDS_lCkJkvP0w2nsaraF1iUI-PfsBGgFDAMnSqGiPEN-oG5sg0RR5aQWAqnixT1BRO0RBcsIWEpJ48Jfztk-ioLi0NlKg-fFfHPUxjXg60DReVG"></p><p>Na printscreenie moÅ¼esz zauwaÅ¼yÄ‡ output z informacjami jakie generowane sÄ… przez skrypt.</p><ul><li>Czy jesteÅ› zalogowany, jeÅ›li nie to poprosi CiÄ™ o zalogowanie siÄ™</li><li>IloÅ›Ä‡&nbsp;znalezionych grup zasobÃ³w oraz zasobÃ³w</li><li>Informacja gdzie i jakie pliki sÄ…&nbsp;tworzone</li><li>Lista zasobÃ³w</li></ul><p>Pliki CSV wyglÄ…dajÄ… nastÄ™pujÄ…co:</p><ul><li>Resource Group</li></ul><p><img src="https://lh3.googleusercontent.com/XiatuhcE3vx4Lr6g5rkz-JP48TjhJ-ydCdwySuAGgBccaVpVZKD9CfPF5xVpIuzU6IFM7PNj939dMpEviYAR3287SCr6F5y2cM4pu1i8500uzKNdRNSh16t8dX9GSosf7J2oDJFa"></p><ul><li>Resources</li></ul><p><img src="https://lh4.googleusercontent.com/m5u5NLpGw8DNyroSByMny-rIZsH11sZMs4tgFMixm_Lepfn0rjNf4XqLET6MvsT3YnK48PesD9GJQUkDtWJIuDKsUh7IolWD7BCDfHSQN4Ug_f6qdWpuPF2ns-8vRmnlRNtWptbp"></p><p>PoniÅ¼ej przedstawiÄ™ edycjÄ™ tagÃ³w dla pliku z zasobami.</p><p><em>Uwaga! JeÅ›li chcesz zachowaÄ‡ kopiÄ™ obecnego stanu, zabezpiecz wygenerowany plik lub zmieÅ„ jego nazwÄ™ na zupeÅ‚nie innÄ….</em>&nbsp;</p><p>Poprawiony plik wyglÄ…da nastÄ™pujÄ…co. ZauwaÅ¼, Å¼e wypeÅ‚niÅ‚em tagi dla wszystkich obiektÃ³w oraz dodaÅ‚em nowy tag: Test:Key, aby pokazaÄ‡ jak wyglÄ…da przypisywanie wielu tagÃ³w.</p><p><img src="https://lh6.googleusercontent.com/q4_FhHhAden4hD-gq6IJjhVRras8g-lAgwqCo4evhui6_dSF1wjIt6rZwHV23YbOWIuvlJihRbleddX46VkkUudBByLuX_lfGlrab1_U8Ya14-pdg9Xhrqd7hdzoQqpsxwaseZle"></p><p>Wynik skryptu z wykonanymi zmianami:</p><p><code>Komenda: ./SetTagsResources.ps1 -path /tags</code></p><p><img src="https://lh4.googleusercontent.com/49zIzivJeCzwtGRSBFcnzG4X0nr3nbtc1dxgJag7q3_tocRbvBcgu0m_DUf11179BBt1GWpHQalOmsyis3CDnEX3xCpgt-1w1Ic_-bR8KFREpnCOP-aXCxmAjefbS7mU7qJbRvkL"></p><p>Efekt zmian w Portalu Azure:</p><p><img src="https://lh4.googleusercontent.com/O0XGlppGQzJYWYNOJcfKkxTo0ZcT4Hstc46TWolZUIr4Bi80Tq8P60Z1IwlMDgU-vwQ4yLvuj1cYWb9RYy67Z4BDPvFGjx704b9ZYUVbGNb9EFUatChC8Vv3YnHQi4g_1Lr1ciL2"></p><p>Skrypt moÅ¼na dostosowaÄ‡&nbsp;do swoich celÃ³w tak, aby dziaÅ‚aÅ‚ na przykÅ‚ad dla wielu subskrypcji. Jest wiele opcji customizacji tego skryptu, ktÃ³re celowo pominÄ…Å‚em. Skrypty dziaÅ‚ajÄ… moduÅ‚owo wiÄ™c moÅ¼na ich Å‚atwo uÅ¼yÄ‡ z innym skryptem, a reszta zostanie przygotowana i wdroÅ¼ona na podstawie wprowadzonych danych z pliku.</p><p>Zapraszam do pozostawienia komentarza!</p>]]></content:encoded>
            <category>azutomation</category>
            <category>csv</category>
            <category>microsoft azure</category>
            <category>raport</category>
            <category>report</category>
            <category>tag</category>
            <category>tagging</category>
            <category>tags</category>
        </item>
        <item>
            <title><![CDATA[WysÅ‚anie Å¼Ä…dania API z PowerShell do Azure DevOps]]></title>
            <link>https://blog.justcloud.pl/wyslanie-zadania-api-z-powershell-do-azure-devops</link>
            <guid>wyslanie-zadania-api-z-powershell-do-azure-devops</guid>
            <pubDate>Mon, 13 Apr 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[PowerShell to nie tylko automatyzacja za pomocÄ… moduÅ‚Ã³w. MoÅ¼emy go rÃ³wnieÅ¼ wykorzystaÄ‡ do wysyÅ‚ania zapytaÅ„ za pomocÄ… API do rÃ³Å¼nych serwisÃ³w. W tym artykule zobaczysz jak to zrobiÄ‡.]]></description>
            <content:encoded><![CDATA[<p>CzÄ™sto stajemy przed wyzwaniem zintegrowania ze sobÄ… wielu narzÄ™dzi. JeÅ¼eli stosujemy PowerShell w celu automatyzacji swojej infrastruktury bÄ…dÅº budowy prostych skryptÃ³w moÅ¼e nam siÄ™ przydaÄ‡ zastosowanie uÅ¼ycia wywoÅ‚ania Å¼Ä…dania API za pomocÄ… PowerShell. PoniÅ¼szy przykÅ‚ad zaprezentuje uÅ¼ycie wysÅ‚ania Å¼Ä…dania za pomocÄ… API do Azure DevOps w celu dodania puli agentowej.</p><p>Referencje API do Azure DevOps sÄ… dostÄ™pne tutaj:&nbsp;</p><p><a href="https://docs.microsoft.com/en-us/rest/api/azure/devops/distributedtask/pools/add?view=azure-devops-rest-5.1" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/rest/api/azure/devops/distributedtask/pools/add?view=azure-devops-rest-5.1</a></p><p>PoniÅ¼szy przykÅ‚adowy skrypt moÅ¼emy rozbudowaÄ‡ dla innych operacji stosujÄ…c odpowiedni uri dla potrzebnej operacji z powyÅ¼szego linku.  </p><p>Na poczÄ…tku definiujemy zmienne:  </p><ul><li>$urlvsts - URL do naszego projektu Azure DevOps</li><li>$token - PAT token (Instrukcja jak wygenerowaÄ‡ token: <a href="https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&amp;tabs=preview-page" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&amp;tabs=preview-page</a>)</li><li>$pool - nazwa puli, ktÃ³rÄ… chcemy utworzyÄ‡</li><li>$encodedPat - przekonwertowanie tokenu na SecureString</li><li>$body - informacje do przekazania w wysyÅ‚anym Å¼Ä…daniu</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$urlvsts = 'https://dev.azure.com/PROJECT-NAME'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$token = 'YOUR-PAT-TOKEN'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pool = 'YOUR-POOL-NAME'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$encodedPat = \[System.Convert\]::ToBase64String(\[System.Text.Encoding\]::UTF8.GetBytes( ":$token"))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$body = "{name:\`"$pool\`", autoProvision: \`"true\`"}"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Komenda <code>Invoke-WebRequest</code> wykonuje wysÅ‚ania Å¼Ä…dania podajÄ…c wczeÅ›niej zdefiniowane zmienne oraz zawiera Uri, czyli miejsce, w ktÃ³re zapuka Å¼Ä…danie, aby ustawiÄ‡ nowÄ… pulÄ™ w Azure DevOps.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-WebRequest \`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -Method POST \`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -Uri "$urlvsts/\_apis/distributedtask/pools?api-version=5.0-preview.1" \`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -UseBasicParsing \`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -Headers @{Authorization = "Basic $encodedPat"} \`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -Body $body \`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -ContentType "application/json"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Screens:</p><p>Code:</p><p><img src="/assets/images/2020-04-13_14h12_09-74a67a70a3044a95c8342ca461fd26c3.png" width="1013" height="314"></p><p>Output:</p><p><img src="/assets/images/2020-04-13_14h12_53-b564469a0b3f4a59f61d76185b092578.png" width="2009" height="523"></p><p>Azure DevOps:</p><p><img src="/assets/images/2020-04-13_14h14_02-1024x604-e6cc533454530d607213bf2bb5b3ea5c.png" width="1024" height="604"></p><p>W prosty sposÃ³b moÅ¼emy teraz zautomatyzowaÄ‡ operacje w Azure DevOps bez uruchamiania portalu. Niestety referencje API dla Azure DevOps nie pozwalajÄ… na wszystko co moÅ¼emy wyklikaÄ‡ w portalu, ale na pewno pomoÅ¼e to w osiÄ…gniÄ™ciu celu. JeÅ›li masz ciekawe przypadki uÅ¼ycia wspomnianego API lub zastanawiasz siÄ™, gdzie moÅ¼na tego uÅ¼yÄ‡ zapraszam do komentowania.</p><p>UÅ¼ycie skryptu moÅ¼ecie rÃ³wnieÅ¼ sprawdziÄ‡ w deploymencie puli agentÃ³w dla Azure DevOps tutaj: <a href="https://github.com/RogalaPiotr/JustCloudPublic/blob/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1" target="_blank" rel="noopener noreferrer">https://github.com/RogalaPiotr/JustCloudPublic/blob/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1</a></p><p>ArtykuÅ‚ dostÄ™pny rÃ³wnieÅ¼ na Medium i LinkedIN:</p><ul><li>(EN) <a href="https://medium.com/@piotr.rogala/api-request-to-azure-devops-from-powershell-2e2f525dbd7a" target="_blank" rel="noopener noreferrer">https://medium.com/@piotr.rogala/api-request-to-azure-devops-from-powershell-2e2f525dbd7a</a></li><li>(PL) <a href="https://www.linkedin.com/pulse/wys%C5%82anie-%C5%BC%C4%85dania-api-z-powershell-do-azure-devops-piotr-rogala" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/pulse/wys%C5%82anie-%C5%BC%C4%85dania-api-z-powershell-do-azure-devops-piotr-rogala</a></li></ul>]]></content:encoded>
            <category>api</category>
            <category>automation</category>
            <category>azure</category>
            <category>azure devops</category>
            <category>powershell</category>
        </item>
        <item>
            <title><![CDATA[IaC control via PowerShell module for ARM templates]]></title>
            <link>https://blog.justcloud.pl/iac-control-via-powershell-module-for-arm-templates</link>
            <guid>iac-control-via-powershell-module-for-arm-templates</guid>
            <pubDate>Sun, 15 Sep 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[Walidowanie szablonÃ³w ARM za pomocÄ… moduÅ‚u PowerShell jest moÅ¼liwe dziÄ™ki nowemu moduÅ‚owi. UÅ¼ycie tego moduÅ‚u pomoÅ¼e Ci sprawdziÄ‡ czy szablon jest poprawny i jakie zmiany wprowadzi na wdraÅ¼anym Å›rodowisku Azure.]]></description>
            <content:encoded><![CDATA[<p>Debug natywnych szablonÃ³w ARM jest ciÄ™Å¼kim procesem dla wielu osÃ³b. Utrzymanie infrastruktury jako kod rÃ³wnieÅ¼ nie jest prostÄ… sprawÄ…, dlatego czÄ™sto uÅ¼ywa siÄ™ Terraforma dla wdroÅ¼eÅ„ w Microsoft Azure.</p><p>Szablony ARM nie posiadajÄ… pliku stanu jak to jest w Terraform dlatego czÄ™sto spotykam siÄ™ z opiniÄ…, Å¼e, ARM'y sÄ… beznadziejnie. Po wdroÅ¼eniu trudno jest utrzymaÄ‡ staÅ‚y rozwÃ³j infrastruktury z tego samego szablonu oraz czÄ™sto problemem jest przewidywalnoÅ›Ä‡ co siÄ™ stanie z obiektami, ktÃ³re juÅ¼ masz. Nie bÄ™dÄ™ siÄ™ rozwodziÅ‚ co lepsze co gorsze, poniewaÅ¼ wiele zaleÅ¼y od naszej wiedzy, podejÅ›cia, problemu lub zlecenia, ktÃ³re wykonujemy. Jako InÅ¼ynier nie przywiÄ…zuje siÄ™ do rozwiÄ…zaÅ„ i uwaÅ¼am, Å¼e do kaÅ¼dego problemu naleÅ¼y podchodziÄ‡ indywidualnie. Moim zdaniem najlepsze rozwiÄ…zania to rozwiÄ…zania natywne nie wymagajÄ…ce tworzenia koÅ‚a na nowo. StÄ…d zachÄ™cam do pisania szablonÃ³w ARM dla Azure.</p><p>Jako pomoc w tworzeniu infrastruktury jako kod (IaC) w Microsoft Azure polecam zapoznaÄ‡ siÄ™ z moduÅ‚em PowerShell: <strong>ARMHelper</strong></p><p><a href="https://www.powershellgallery.com/packages/ARMHelper/0.6.2" target="_blank" rel="noopener noreferrer">https://www.powershellgallery.com/packages/ARMHelper/0.6.2</a></p><p>Za pomocÄ… komendy: Test-ARMExistingResource moÅ¼emy zbudowaÄ‡ polecenie, ktÃ³re sprawdzi nam wskazany szablon w kontekÅ›cie z deploy'owanych zasobÃ³w w Azure i wyÅ›wietli co siÄ™ stanie. PrzykÅ‚ad poniÅ¼ej przedstawia stworzonÄ… resource groupe bez zasobÃ³w:</p><p>UÅ¼yÅ‚em szablonu z mojego repo: <a href="https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-shutdown-on-time" target="_blank" rel="noopener noreferrer">https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-shutdown-on-time</a><br>
<!-- -->Wykonuje kolejno komendy:</p><p>Tworzenie nowej resource groupy:</p><p><code>New-AzResourceGroup -Name 'simple-vm-shutdown-on-time' -Location westeurope</code></p><p>Sprawdzenie co wyÅ›wietli poleniecenie Test-ARMExistingResource:</p><p><code>Test-ARMExistingResource -ResourceGroupName 'simple-vm-shutdown-on-time' -TemplateFile .\\azuredeploy.json -TemplateParameterFile .\\azuredeploy.parameters.json -Verbose</code></p><p><img src="/assets/images/2019-09-15_12h46_05-8727ff774509b20d633ad59e6525eba9.png" width="1732" height="565"></p><p>Wynikiem jest informacja co zostanie utworzone. Super sprawa, to teraz zrobie deployment szablonu i sprawdzimy ponownie.</p><p><code>New-AzResourceGroupDeployment -ResourceGroupName 'simple-vm-shutdown-on-time' -TemplateFile .\\azuredeploy.json -TemplateParameterFile .\\azuredeploy.parameters.json -Verbose</code></p><p>Niestety miaÅ‚em problem z moduÅ‚em Shutdown i szablon wdroÅ¼yÅ‚ siÄ™ niepoprawnie, dlatego sprawdziÅ‚em co wyÅ›wietli Test-ARMExistResource.</p><p><code>Test-ARMExistingResource -ResourceGroupName 'simple-vm-shutdown-on-time' -TemplateFile .\\azuredeploy.json -TemplateParameterFile .\\azuredeploy.parameters.json -Verbose</code></p><p><img src="/assets/images/2019-09-15_13h01_42-e2df42c028dec7e6b2a418ca36325840.png" width="1738" height="457"></p><p>Jak widaÄ‡ polecenie poprawnie zwrÃ³ciÅ‚o co jest do poprawienia i co zostanie zmienione(inkrementalnie).</p><p>Ostatni test to z argumentem "-Mode Complete" czyli wykonanie szablonu, ktÃ³ry dostosuje wszystkie zasoby niezaleÅ¼nie od tego co jest stworzone w resource groupie do mojego szablonu.</p><p><code>Test-ARMExistingResource -ResourceGroupName 'simple-vm-shutdown-on-time' -TemplateFile .\\azuredeploy.json -TemplateParameterFile .\\azuredeploy.parameters.json -Verbose -Mode Complete</code></p><p><img src="/assets/images/2019-09-15_13h02_32-cbf72f27f5da36e8dfc3c71bbaebd55f.png" width="1824" height="587"></p><p>Teraz moÅ¼na byÄ‡ pewniejszym co siÄ™ stanie z wdroÅ¼eniem po maÅ‚ych zmianach w szablonie.</p><p>Mam nadzieje Å¼e przyda Ci siÄ™ ta wiedza :)</p>]]></content:encoded>
            <category>arm</category>
            <category>azure</category>
            <category>iac</category>
            <category>module</category>
            <category>powershell</category>
            <category>templates</category>
        </item>
        <item>
            <title><![CDATA[SkÄ…d uczyÄ‡ siÄ™ o Microsoft Azure?]]></title>
            <link>https://blog.justcloud.pl/skad-uczyc-sie-o-microsoft-azure</link>
            <guid>skad-uczyc-sie-o-microsoft-azure</guid>
            <pubDate>Sun, 18 Nov 2018 00:00:00 GMT</pubDate>
            <description><![CDATA[Chcesz zaczÄ…Ä‡ nauke o Microsoft Azure? W tym artykule znajdziesz linki, ktÃ³re napewno CiÄ™ zainteresujÄ…!]]></description>
            <content:encoded><![CDATA[<p>Po ostatniej prezentacji naszedÅ‚ mnie pomysÅ‚ zwiÄ…zany z utworzeniem miejsca skÄ…d moÅ¼na siÄ™ uczyÄ‡ chmury Microsoft Azure. StÄ…d postanowiÅ‚em zebraÄ‡ interesujÄ…ce linki w jednym miejscu gdzie znajdziecie rekomendowane przeze mnie jak i przez innych ekspertÃ³w miejsca do nauki. WiÄ™kszoÅ›Ä‡ z poniÅ¼szych linkÃ³w jest darmowa i takie bÄ™dÄ™ staraÅ‚ siÄ™ udostÄ™pniaÄ‡. JeÅ›li chciaÅ‚byÅ› dodaÄ‡ ciekawe miejsce, ktÃ³re rekomendujesz dodaj je w komentarzu, pomoÅ¼e to w udoskonaleniu listy.</p><p>JeÅ›li wiesz czego konkretnie szukasz moÅ¼esz uÅ¼yÄ‡ wyszukiwarki aby skoncentrowaÄ‡ siÄ™ na danym problemie: </p><p><a href="https://www.youtube.com/watch?v=Rkxg03z2PEo" target="_blank" rel="noopener noreferrer"><img src="https://img.youtube.com/vi/Rkxg03z2PEo/0.jpg"></a></p><p>A, tak na powaÅ¼nie moÅ¼esz zaczerpnÄ…Ä‡ wiedzy w poniÅ¼szych miejscach.</p><p>Grupa Microsoft Azure User Group Poland na Facebook'u:&nbsp;<a href="https://www.facebook.com/groups/azureugpl/" target="_blank" rel="noopener noreferrer">https://www.facebook.com/groups/azureugpl/</a></p><p><strong>Video:</strong></p><ul><li>Azure Developer:&nbsp;<a href="https://docs.microsoft.com/pl-pl/learn/browse/?roles=developer&amp;products=azure" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/pl-pl/learn/browse/?roles=developer&amp;products=azure</a></li><li>Azure Administrator:&nbsp;<a href="https://docs.microsoft.com/pl-pl/learn/browse/?roles=administrator&amp;products=azure" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/pl-pl/learn/browse/?roles=administrator&amp;products=azure</a></li><li>Azure Solution Architect:&nbsp;<a href="https://docs.microsoft.com/pl-pl/learn/browse/?roles=solution-architect&amp;products=azure" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/pl-pl/learn/browse/?roles=solution-architect&amp;products=azure</a></li><li>Azure Friday:&nbsp;<a href="https://channel9.msdn.com/Shows/Azure-Friday" target="_blank" rel="noopener noreferrer">https://channel9.msdn.com/Shows/Azure-Friday</a></li><li>Microsoft Self-paced Labs:&nbsp;<a href="https://www.microsoft.com/handsonlabs/selfpacedlabs" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/handsonlabs/selfpacedlabs</a></li><li>Microsoft Virtual Academy:&nbsp;<a href="https://mva.microsoft.com/search/SearchResults.aspx#!q=azure&amp;orderby=publishedtime&amp;lang=1033" target="_blank" rel="noopener noreferrer">https://mva.microsoft.com/search/SearchResults.aspx#!q=azure&amp;orderby=publishedtime&amp;lang=1033</a></li><li>Azure Tips and Tricks:&nbsp;<a href="https://www.michaelcrump.net/azure-tips-and-tricks-complete-list/" target="_blank" rel="noopener noreferrer">https://www.michaelcrump.net/azure-tips-and-tricks-complete-list/</a></li><li>Pluralsight:&nbsp;<a href="https://www.pluralsight.com/search?q=azure" target="_blank" rel="noopener noreferrer">https://www.pluralsight.com/search?q=azure</a></li></ul><p><strong>Blogi&nbsp;Polskich ekspertÃ³w:</strong></p><ul><li>MichaÅ‚ Furmankiewicz: <a href="http://cloudarchitects.pl/" target="_blank" rel="noopener noreferrer">http://cloudarchitects.pl/</a></li><li>MichaÅ‚ SmereczyÅ„ski: <a href="https://lnx.azurewebsites.net/" target="_blank" rel="noopener noreferrer">https://lnx.azurewebsites.net/</a></li><li>Emil Wasilewski:&nbsp;<a href="http://zapytajemila.pl/" target="_blank" rel="noopener noreferrer">http://zapytajemila.pl/</a></li><li>Åukasz KaÅ‚uÅ¼ny:&nbsp;<a href="https://kaluzny.io/" target="_blank" rel="noopener noreferrer">https://kaluzny.io/</a></li><li>Sebastian Fyda:&nbsp;<a href="http://blog.spiderweb.pl/" target="_blank" rel="noopener noreferrer">http://blog.spiderweb.pl/</a></li><li>Piotr Rogala:&nbsp;<a href="https://justcloud.azurewebsites.net/blog/" target="_blank" rel="noopener noreferrer">https://justcloud.azurewebsites.net/blog/</a></li><li>Szymon Pulka (DEV):&nbsp;<a href="https://devincloud.pl/" target="_blank" rel="noopener noreferrer">https://devincloud.pl/</a></li><li>Mateusz Dudek (DEV):&nbsp;<a href="https://mateuszdudek.pl/blog/" target="_blank" rel="noopener noreferrer">https://mateuszdudek.pl/blog/</a></li></ul><p><strong>Book's</strong></p><ul><li>Free eBooks from Microsoft Press<ul><li>Microsoft Azure Essentials: Fundamentals of Azure, Second Edition</li><li>Introduction to Windows Containers</li><li>Microsoft Azure Essentials Migrating SQL Server Databases to Azure</li><li>Microsoft Azure Essentials: Azure Web Apps for Developers</li></ul></li><li>The Developerâ€™s Guide to Microsoft Azure:&nbsp;<a href="https://azure.microsoft.com/en-us/blog/free-ebook-the-developer-s-guide-to-microsoft-azure-now-available/" target="_blank" rel="noopener noreferrer">https://azure.microsoft.com/en-us/blog/free-ebook-the-developer-s-guide-to-microsoft-azure-now-available/</a></li></ul><p><strong>Certyfikaty:</strong></p><ul><li>Lista moÅ¼liwych certyfikatÃ³w do zrobienia dot. Azure:&nbsp;<a href="https://www.microsoft.com/en-us/learning/azure-exams.aspx" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/en-us/learning/azure-exams.aspx</a></li></ul>]]></content:encoded>
            <category>azure</category>
            <category>course</category>
            <category>courses</category>
            <category>kurs</category>
            <category>kursy</category>
            <category>learn</category>
            <category>microsoft azure</category>
            <category>nauka</category>
        </item>
        <item>
            <title><![CDATA[Auto deployment VM with VSTS agent for pool]]></title>
            <link>https://blog.justcloud.pl/auto-deployment-vm-with-vsts-agent-for-pool</link>
            <guid>auto-deployment-vm-with-vsts-agent-for-pool</guid>
            <pubDate>Sun, 27 May 2018 00:00:00 GMT</pubDate>
            <description><![CDATA[Azure DevOps agent to waÅ¼ny element wszystkich wdroÅ¼eÅ„. Potrzebujesz stworzyÄ‡ wÅ‚asnego agenta ADO? Zobacz jak to zrobiÄ‡ w prosty i automatyczny sposÃ³b! Wszystko znajdziesz we wpisie.]]></description>
            <content:encoded><![CDATA[<p>Wszyscy ktÃ³ry robiÄ… depyolemnty z VSTS spotykajÄ… siÄ™ z sytuacjÄ…, kiedy standardowe 240min siÄ™ koÅ„czy i trzeba stworzyÄ‡ sobie takÄ… maszynÄ™. Sam robiÅ‚em takÄ… maszynÄ™ parÄ™ razy i kiedy znÃ³w pojawiÅ‚a siÄ™ ta koniecznoÅ›Ä‡ postanowiÅ‚em stworzyÄ‡ automatyczny deployment ktÃ³ry nam stworzy z JSON'a caÅ‚a maszynkÄ™ i podepnie jÄ… do Agent pool w VSTS.</p><p>MiaÅ‚em parÄ™ pomysÅ‚Ã³w, aby zrobiÄ‡ bardzo uniwersalny template ktÃ³ry nie tylko przyda siÄ™ wam, ale rÃ³wnieÅ¼ mi w przyszÅ‚oÅ›ci do budowania innych szablonÃ³w. TakÅ¼e w skrÃ³cie opiszÄ™ ciekawostki ktÃ³re zastosowaÅ‚em szablonie, ktÃ³ry znajdziecie na moim GitHubie.</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="githubhttpsgithubcomrogalapiotrjustcloudpublictreemastersimple-vm-with-installation-vsts-agent"><strong>GitHub</strong>:&nbsp;<a href="https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-with-installation-vsts-agent" target="_blank" rel="noopener noreferrer">https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-with-installation-vsts-agent</a><a class="hash-link" href="#githubhttpsgithubcomrogalapiotrjustcloudpublictreemastersimple-vm-with-installation-vsts-agent" title="Direct link to heading">â€‹</a></h5><p>ZaÅ‚oÅ¼enie dotyczÄ…ce szablonu: chciaÅ‚bym dodaÄ‡ informacjÄ™, gdzie waÅ¼nym jest zwrÃ³cenie uwagi, Å¼e maszyna ma byÄ‡ odizolowana od naszej sieci wewnÄ™trznej, dlatego szablon jest infrastruktura stand alone, aby byÅ‚o bezpiecznie i w razie czego moÅ¼na jÄ… usunÄ… lub powoÅ‚aÄ‡ wiÄ™cej agentÃ³w do deploymentâ€™Ã³w.</p><h1>Opis szablonu</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="sekcja-parameters"><strong>Sekcja Parameters:</strong><a class="hash-link" href="#sekcja-parameters" title="Direct link to heading">â€‹</a></h2><p>w tej sekcji podajemy dane ktÃ³re przydadzÄ… nam siÄ™ do deplymentâ€™u i automatycznego podÅ‚Ä…czenia do VSTS'a.</p><ul><li><strong>adminUsername</strong>, <strong>adminPassword</strong> - lokalny uÅ¼ytkownik i hasÅ‚o,</li><li><strong>dnsLabelPrefix</strong> - zostanie automatycznie wygenerowany podczas deploymentâ€™u, wiÄ™c nie ma koniecznoÅ›ci go zmieniaÄ‡,</li><li><strong>vmName</strong> - nazwa naszej maszyny oraz na podstawie tej nazwy zostanÄ… nazwane wszystkie nasze resource jest: VNET, NSG, Storage...</li><li><strong>urlvsts</strong> - adres do naszego projektu VSTS np.: <a href="https://project1.visualstudio.com" target="_blank" rel="noopener noreferrer">https://project1.visualstudio.com</a>,</li><li><strong>auth</strong> - rodzaj poÅ›wiadczenia - wybrany domyÅ›lnie PAT,</li><li><strong>token</strong> - token security ktÃ³ry umoÅ¼liwi nam podÅ‚Ä…czenie siÄ™ do projektu. WiÄ™cej informacji jak stworzyÄ‡ Security Token poniÅ¼ej:<ul><li><a href="https://docs.microsoft.com/en-us/vsts/build-release/actions/agents/v2-windows?view=vsts" target="_blank" rel="noopener noreferrer"><strong>https://docs.microsoft.com/en-us/vsts/build-release/actions/agents/v2-windows?view=vsts</strong></a></li></ul></li><li><strong>pool</strong> - nazwa puli, do ktÃ³rej zostanie dodana maszyna w VSTS'ie - ustawiony jest na default</li><li><strong>AccessIPNSG</strong> - adres, ktÃ³ry tutaj podacie zostanie dodany do NSG i tylko z tego adresu dostaniecie siÄ™ po RDP do maszyny,</li><li><strong>Tag</strong> - tagi mogÄ… ulec waszej modyfikacji ustawione sÄ… na Project: VSTSAgent.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="sekcja-variables"><strong>Sekcja Variables:</strong><a class="hash-link" href="#sekcja-variables" title="Direct link to heading">â€‹</a></h2><ul><li><strong>vmsize</strong> - ustawiony na "Standard<!-- -->_<!-- -->B1s" - dosyÄ‡ tani i wystarczajÄ…cy na maszynÄ™ deploymentâ€™owy - pamiÄ™taj, aby sprawdziÄ‡, czy masz moÅ¼liwoÅ›Ä‡ deployâ€™owania tej maszyny w swojej subskrypcji w innym przypadku zgÅ‚oÅ› request do supportu Microsoft w celu uruchomienia wielkoÅ›ci B<!-- -->_<!-- -->size.</li><li><strong>urldonwloadagent</strong> - w tym miejscu jest podany link do Å›ciÄ…gniÄ™cia aktualnego zip'a z agentem VSTS - w razie zmiany wersji naleÅ¼y zaktualizowaÄ‡ link na aktualny</li><li><strong>filescriptURI</strong> - skrypt napisany przeze mnie w celu automatycznego pobrania i zainstalowania agenta na maszynie:&nbsp;<a href="https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1</a></li><li><strong>filescriptURISplit</strong> - bardzo ciekawa funkcja, ktÃ³ra rozbija powyÅ¼szy url na tekst tam, gdzie jest slah "/" co w efekcie generuje nam obiekt<ul><li>wiÄ™cej ciekawych informacji w dokumentacji Microsoft:&nbsp;<strong><a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-template-functions" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-template-functions</a></strong></li></ul></li><li><strong>filescriptName</strong> - kolejna fajna funkcja, gdzie na podstawie powyÅ¼szego splita zabieramy nazwÄ™ skryptu, ktÃ³ry posÅ‚uÅ¼y nam do instalacji w CustomScriptExtension,</li><li><strong>agentname</strong> - kaÅ¼dy dodany Agent do puli w VSTS bÄ™dzie nosiÅ‚ nazwÄ™ NazwaMaszynyagent.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="sekcja-resources"><strong>Sekcja Resources:</strong><a class="hash-link" href="#sekcja-resources" title="Direct link to heading">â€‹</a></h2><ul><li><strong>type: Microsoft.Network/networkSecurityGroups</strong> - NSG z dostÄ™pem RDP tylko z adresu IP ktÃ³ry dodamy podczas deployâ€™mentu parametr: AccessIPNSG</li><li><strong>type: Microsoft.Network/publicIPAddresses</strong> - Publiczny adres dla naszej VM, aby mÃ³c siÄ™ do niej podÅ‚Ä…czyÄ‡ z zewnÄ…trz.</li><li><strong>type: Microsoft.Network/virtualNetworks</strong> - VNet</li><li><strong>type: Microsoft.Compute/virtualMachines</strong> - tworzenie maszyny wirtualnej z Windows 2016 i Managed Disk<ul><li><strong>type: Microsoft.Compute/virtualMachines/extensions</strong> - instalacja agenta VSTS, bazujÄ…c na napisanym skrypcie i udostÄ™pnionym na GitHubie:&nbsp;vstsagent.ps1 zostanie on uÅ¼yty podczas deplyomentâ€™u a podczas jego wykonywaniu dodamy informacjÄ™ zwiÄ…zane z url VSTS, tokenem itp. PeÅ‚na komenda w linii 257: "commandToExecute"</li></ul></li><li><strong>type: Microsoft.DevTestLab/schedules</strong> - dziÄ™ki temu nasza maszynie bÄ™dzie wyÅ‚Ä…czana codziennie o 18:00 zona: W. Europe Standard Time - ten feature dziaÅ‚a tylko kiedy maszyna jest wÅ‚Ä…czona pozwoli to nam zapomnieÄ‡ o wyÅ‚Ä…czaniu, a mimo wszystko nie bÄ™dziemy traciÄ‡ pieniÄ™dzy za jej bezczynnoÅ›Ä‡.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="sekcja-outputs"><strong>Sekcja Outputs:</strong><a class="hash-link" href="#sekcja-outputs" title="Direct link to heading">â€‹</a></h2><ul><li><strong>PublicDNS</strong> - po wykonaniu deploymentâ€™u wyÅ›wietli nam publiczny adres DNS dla VM,</li><li><strong>Hostname</strong> - wyÅ›wietli nazwÄ™ maszyny, ktÃ³rÄ… wprowadziliÅ›my w parametrach,</li><li><strong>VSTSAgentName</strong> - wyÅ›wietli nazwÄ™ agenta jaka bÄ™dzie widoczna w VSTS,</li><li><strong>VSTSProjectName</strong> - wyÅ›wietli nazwÄ™ projektu VSTS jaki zostaÅ‚ wprowadzony,</li><li><strong>ScriptURI</strong> - wyÅ›wietli ÅºrÃ³dÅ‚o z jakiego zostaÅ‚ pobrany skrypt do instalacji Agenta,</li><li><strong>AccessRDPFrom</strong> - wyÅ›wietli adres IP ktÃ³ry zostaÅ‚ dodany do NSG, aby miaÅ‚ dostÄ™p do RDP</li></ul><h1>Szablon:</h1><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "contentVersion": "1.0.0.0",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "parameters": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "adminUsername": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Username for the Virtual Machine."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "adminPassword": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "securestring",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Password for the Virtual Machine."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "dnsLabelPrefix": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "defaultValue": "\[concat('x', uniqueString(resourceGroup().id))\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Unique DNS Name for the Public IP used to access the Virtual Machine."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "vmName": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Unique DNS Name for the Public IP used to access the Virtual Machine."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "urlvsts": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "URL for your VSTS Project ex. https://project1.visualstudio.com."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "auth": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "defaultValue": "pat",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Unique DNS Name for the Public IP used to access the Virtual Machine."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "token": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "securestring",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Security token for VSTS project."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "pool": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "defaultValue": "default",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Pool name in VSTS - Default is a main."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "AccessIPNSG": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "description": "Your publif IP it will added for NSG for connection via RDP."</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "tag": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "object",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "defaultValue": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "key1": "Project",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "value1": "VSTSAgent"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "metadata": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "description": "Tag Values"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "variables": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "windowsOSVersion": "2016-Datacenter",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "vmsize": "Standard\_B1s",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "publicIPAddressName": "\[concat(parameters('vmName'), '-pip')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "virtualNetworkName": "\[concat(parameters('vmName'), '-vnet')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "NSGname": "\[concat(parameters('vmName'), '-nsg')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "nicName": "\[concat(parameters('vmName'), '-nic')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "subnetName": "\[concat(parameters('vmName'), '-subnet')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "addressPrefix": "10.0.0.0/16",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "subnetPrefix": "10.0.0.0/24",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "subnetRef": "\[resourceId('Microsoft.Network/virtualNetworks/subnets', variables('virtualNetworkName'), variables('subnetName'))\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "urldonwloadagent": "https://vstsagentpackage.azureedge.net/agent/2.133.3/vsts-agent-win-x64-2.133.3.zip",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "filescriptURI": "https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "filescriptURISplit": "\[split(variables('filescriptURI'), '/')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "filescriptName": "\[last(variables('filescriptURISplit'))\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "agentname": "\[concat(parameters('vmName'), 'agent')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "resources": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "Microsoft.Network/networkSecurityGroups",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "name": "\[variables('NSGName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "apiVersion": "2018-03-01",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "securityRules": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "name": "RDP",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "description": "Allow IP for RDP",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "protocol": "TCP",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "sourcePortRange": "\*",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "destinationPortRange": "3389",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "sourceAddressPrefix": "\[parameters('AccessIPNSG')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "destinationAddressPrefix": "\*",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "access": "Allow",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "priority": 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "direction": "Inbound"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "apiVersion": "2016-03-30",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "Microsoft.Network/publicIPAddresses",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "name": "\[variables('publicIPAddressName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "publicIPAllocationMethod": "Dynamic",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "dnsSettings": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "domainNameLabel": "\[parameters('dnsLabelPrefix')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "apiVersion": "2016-03-30",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "Microsoft.Network/virtualNetworks",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "name": "\[variables('virtualNetworkName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "dependsOn": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[resourceId('Microsoft.Network/networkSecurityGroups/', variables('NSGName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        \],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "addressSpace": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "addressPrefixes": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "\[variables('addressPrefix')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "subnets": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "name": "\[variables('subnetName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "addressPrefix": "\[variables('subnetPrefix')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "networkSecurityGroup": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  "id": "\[resourceId('Microsoft.Network/networkSecurityGroups',variables('NSGName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "apiVersion": "2016-03-30",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "Microsoft.Network/networkInterfaces",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "name": "\[variables('nicName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "dependsOn": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[resourceId('Microsoft.Network/publicIPAddresses/', variables('publicIPAddressName'))\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[resourceId('Microsoft.Network/virtualNetworks/', variables('virtualNetworkName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        \],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "ipConfigurations": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "name": "ipconfig1",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "privateIPAllocationMethod": "Dynamic",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "publicIPAddress": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  "id": "\[resourceId('Microsoft.Network/publicIPAddresses',variables('publicIPAddressName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "subnet": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  "id": "\[variables('subnetRef')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "apiVersion": "2016-04-30-preview",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "Microsoft.Compute/virtualMachines",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "name": "\[parameters('vmName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "dependsOn": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[resourceId('Microsoft.Network/networkInterfaces/', variables('nicName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        \],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "licenseType": "Windows\_Server",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "hardwareProfile": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "vmSize": "\[variables('vmsize')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "osProfile": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "computerName": "\[parameters('vmName')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "adminUsername": "\[parameters('adminUsername')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "adminPassword": "\[parameters('adminPassword')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "storageProfile": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "imageReference": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "publisher": "MicrosoftWindowsServer",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "offer": "WindowsServer",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "sku": "\[variables('windowsOSVersion')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "version": "latest"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "osDisk": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "createOption": "FromImage",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "name": "\[concat(parameters('vmName'), '-osdisk')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "networkProfile": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "networkInterfaces": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "id": "\[resourceId('Microsoft.Network/networkInterfaces',variables('nicName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "resources": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "name": "\[concat(parameters('vmName'),'/VSTSAgentInstall')\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "type": "Microsoft.Compute/virtualMachines/extensions",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "dependsOn": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "\[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            \],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "apiVersion": "2015-06-15",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "publisher": "Microsoft.Compute",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "type": "CustomScriptExtension",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "typeHandlerVersion": "1.9",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "autoUpgradeMinorVersion": true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "settings": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "fileUris": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  "\[variables('filescriptURI')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "protectedSettings": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "commandToExecute": "\[concat('powershell -ExecutionPolicy Unrestricted -File ',variables('filescriptName'),' -url ',variables('urldonwloadagent'),' -urlvsts ',parameters('urlvsts'),' -auth ',parameters('auth'),' -token ',parameters('token'),' -pool ',parameters('pool'),' -agentname ',variables('agentname'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        \]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "apiVersion": "2016-05-15",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "Microsoft.DevTestLab/schedules",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "name": "\[concat('shutdown-computevm-', parameters('vmName'))\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "location": "\[resourceGroup().location\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "tags": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[parameters('tag').key1\]": "\[parameters('tag').value1\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "dependsOn": \[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "\[resourceId('Microsoft.Compute/virtualMachines/', parameters('vmName'))\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        \],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "properties": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "status":"Enabled",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "timeZoneId":"W. Europe Standard Time",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "taskType":"ComputeVmShutdownTask",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "notificationSettings":{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "status":"Disabled",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "timeInMinutes":15,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "webhookUrl":null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "targetResourceId":"\[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))\]",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "dailyRecurrence":{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "time":"1800"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "outputs": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "PublicDNS": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type" : "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "\[reference(variables('publicIPAddressName')).dnsSettings.fqdn\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "HostName": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type" : "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "\[parameters('vmName')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "VSTSAgentName": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type" : "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "\[variables('agentname')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "VSTSProjectName": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type" : "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "\[parameters('urlvsts')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "ScritpURI": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type" : "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "\[variables('filescriptURI')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "AccessRDPFrom": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type" : "string",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "\[parameters('accessIPNSG')\]"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h1><strong>PrzykÅ‚ad:</strong></h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="aby-wykonaÄ‡-deployment-naleÅ¼y-utworzyÄ‡-resource-groupÄ™"><strong>Aby wykonaÄ‡ deployment naleÅ¼y utworzyÄ‡ Resource Group'Ä™:</strong><a class="hash-link" href="#aby-wykonaÄ‡-deployment-naleÅ¼y-utworzyÄ‡-resource-groupÄ™" title="Direct link to heading">â€‹</a></h3><p><code>New-AzureRMResourceGroup -Name VSTS -Location westeurope</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="wykonanie-deploymentu"><strong>Wykonanie deploymentâ€™u:</strong><a class="hash-link" href="#wykonanie-deploymentu" title="Direct link to heading">â€‹</a></h3><p><code>New-AzureRMResourceGroupDeployment -ResourceGroupName VSTS -TemplateURI "https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/azuredeploy.json" -Verbose</code></p><p><strong>Efekt w portalu po deployâ€™mencie:</strong></p><p><a target="_blank" href="/assets/files/Clipboard21-8d851887072ff59a7d848fb97d94ba0e.jpg"><img src="/assets/images/Clipboard21-8d851887072ff59a7d848fb97d94ba0e.jpg" width="1360" height="637"></a></p><p><strong>Widok puli agentÃ³w w VSTS:</strong></p><p><a target="_blank" href="/assets/files/Clipboard22-1b82d9e149275cd7f3aa92dc67e94dc2.jpg"><img src="/assets/images/Clipboard22-1b82d9e149275cd7f3aa92dc67e94dc2.jpg" width="925" height="335"></a></p><p>Maszyna jest gotowa do deployâ€™mentÃ³w, jeÅ›li potrzebujesz wiÄ™cej maszyn moÅ¼esz bez oporu deployâ€™owaÄ‡ wiÄ™kszÄ… iloÅ›Ä‡ :)</p><p>Czas deplymentu to: 15 minutes 46 seconds.</p>]]></content:encoded>
            <category>arm</category>
            <category>automation</category>
            <category>azure</category>
            <category>deplyoment</category>
            <category>json</category>
            <category>microsoft</category>
            <category>vsts</category>
            <category>ado</category>
        </item>
    </channel>
</rss>