"use strict";(self.webpackChunkjustcloudblog=self.webpackChunkjustcloudblog||[]).push([[9450],{6029:function(e){e.exports=JSON.parse('{"blogPosts":[{"id":"welcome","metadata":{"permalink":"/welcome","source":"@site/blog/2022-01-22-welcome.md","title":"Nowa ods\u0142ona","description":"Nowy rok 2022 b\u0119dzie czasem zmian dla moich aktywno\u015bci w Internecie. Rozpoczynam od zmian zwi\u0105zanych z blogiem i aktywno\u015bciami IT w community.","date":"2022-01-22T00:00:00.000Z","formattedDate":"January 22, 2022","tags":[{"label":"welcome","permalink":"/tags/welcome"},{"label":"first post","permalink":"/tags/first-post"},{"label":"blog","permalink":"/tags/blog"}],"readingTime":0.305,"truncated":true,"authors":[{"name":"Piotr Rogala","title":"MVP Azure & owner JustCloud.pl","url":"https://github.com/RogalaPiotr","imageURL":"https://avatars.githubusercontent.com/u/31566956?v=4","key":"progala"}],"frontMatter":{"slug":"welcome","title":"Nowa ods\u0142ona","description":"Nowy rok 2022 b\u0119dzie czasem zmian dla moich aktywno\u015bci w Internecie. Rozpoczynam od zmian zwi\u0105zanych z blogiem i aktywno\u015bciami IT w community.","authors":["progala"],"tags":["welcome","first post","blog"],"keywords":["justcloud","nowa ods\u0142ona","2022"]},"nextItem":{"title":"Przyspieszenie pracy nad tagowaniem zasob\xf3w za pomoc\u0105 PowerShell - Tag raport Microsoft Azure","permalink":"/tags-in-azure"}},"content":"Witam na nowej stronie gdzi\u0119 b\u0119d\u0119 wrzuca\u0142 nowe posty zwi\u0105zane z Microsoft Azure oraz Cloud\u2601\ufe0f. Nowy rok 2022 mam nadziej\u0119 \u017ce przyniesie wiele pozytywnych zmian. Dlatego zapraszam do kontaktu i odwiedzin mojej strony.\\n\\nNowe linki i ma\u0142e zmiany:\\n\\n* [JustCloud \u2601\ufe0f Page](https://web.justcloud.pl)\\n* [JustCloud \u2601\ufe0f Blog](https://blog.justcloud.pl)\\n\\nW najbli\u017cszym czasie\xa0ogarn\u0119\xa0r\xf3wnie\u017c uzupe\u0142nienie bloga o stare posty \ud83d\ude43.\\n\\nDzi\u0119ki i do zobaczenia!\\n\\n![welcome](https://images.unsplash.com/photo-1472898965229-f9b06b9c9bbe?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2070&q=80)\\n\\n\x3c!--truncate--\x3e"},{"id":"tags-in-azure","metadata":{"permalink":"/tags-in-azure","source":"@site/blog/2021-06-03-tags-in-azure/index.md","title":"Przyspieszenie pracy nad tagowaniem zasob\xf3w za pomoc\u0105 PowerShell - Tag raport Microsoft Azure","description":"Zastanawiasz si\u0119 jak tagowa\u0107 zasoby w Azure? W tym artykule dok\u0142adnie opisuje jak to zrobi\u0107 dla ma\u0142ych i du\u017cych \u015brodowisk w Auzre.","date":"2021-06-03T00:00:00.000Z","formattedDate":"June 3, 2021","tags":[{"label":"azutomation","permalink":"/tags/azutomation"},{"label":"csv","permalink":"/tags/csv"},{"label":"microsoft azure","permalink":"/tags/microsoft-azure"},{"label":"raport","permalink":"/tags/raport"},{"label":"report","permalink":"/tags/report"},{"label":"tag","permalink":"/tags/tag"},{"label":"tagging","permalink":"/tags/tagging"},{"label":"tags","permalink":"/tags/tags"}],"readingTime":2.995,"truncated":true,"authors":[{"name":"Piotr Rogala","title":"MVP Azure & owner JustCloud.pl","url":"https://github.com/RogalaPiotr","imageURL":"https://avatars.githubusercontent.com/u/31566956?v=4","key":"progala"}],"frontMatter":{"slug":"tags-in-azure","title":"Przyspieszenie pracy nad tagowaniem zasob\xf3w za pomoc\u0105 PowerShell - Tag raport Microsoft Azure","description":"Zastanawiasz si\u0119 jak tagowa\u0107 zasoby w Azure? W tym artykule dok\u0142adnie opisuje jak to zrobi\u0107 dla ma\u0142ych i du\u017cych \u015brodowisk w Auzre.","date":"2021-06-03","authors":["progala"],"tags":["azutomation","csv","microsoft azure","raport","report","tag","tagging","tags"],"keywords":["justcloud","powershell","api","tagowanie","tags","automatyzacja","automation","csv","azure","microsoft azure"]},"prevItem":{"title":"Nowa ods\u0142ona","permalink":"/welcome"},"nextItem":{"title":"Wys\u0142anie \u017c\u0105dania API z PowerShell do Azure DevOps","permalink":"/wyslanie-zadania-api-z-powershell-do-azure-devops"}},"content":"Kiedy\u015b przygotowa\u0142em ten skrypt \u017ceby szybko m\xf3c otagowa\u0107 wiele zasob\xf3w wdro\u017conych na platformie Microsoft Azure. Jest wiele mo\u017cliwo\u015bci jak to zrobi\u0107 szybko, prosto, ale stara\u0142em si\u0119 zrobi\u0107 uniwersalne rozwi\u0105zanie b\u0119d\u0105ce \u0142atwe oraz bezpieczne w u\u017cyciu. Dlatego postanowi\u0142em zrobi\u0107 jeden skrypt, kt\xf3ry generuje nam wszystkie zasoby do pliku CSV. A drugi skrypt na podstawie pliku CSV b\u0119dzie pobiera\u0142 z niego dane zasob\xf3w i nadpisywa\u0142 je na platformie.\\n\\nSkrypty s\u0105 dost\u0119pne na GitHub:\\n\\n- [https://github.com/RogalaPiotr/JustCloudPublic/tree/master/azure-tags-report](https://github.com/RogalaPiotr/JustCloudPublic/tree/master/azure-tags-report)\\n\\nOpis skrypt\xf3w:\\n\\n- GetAllTags.ps1- generuje dwa pliki CSV. Jeden plik dla Resource Group, a drugi plik dla Resources. Jest to istotne poniewa\u017c mamy oddzielone grupy i mo\u017cemy inaczej tagowa\u0107 grupy od zasob\xf3w bez szukania typ\xf3w zasob\xf3w.\\n- SetTagsResourceGroups.ps1 - skrypt, kt\xf3ry pobiera dane z pliku CSV gdzie jest spis Resource Group z tagami do wdro\u017cenia.\\n- SetTagsResources.ps1- skrypt, kt\xf3ry pobiera dane z pliku CSV gdzie zapisane mamy zasoby z tagami do wdro\u017cenia.\\n\\n\x3c!--truncate--\x3e\\n\\nTaki podzia\u0142 daje nam:\\n\\n1. Zapis stanu obecnego tag\xf3w zapisanych do pliku CSV. Jest to raport tag\xf3w czyli obecny stan wdro\u017cony tag\xf3w.\\n2. Podzia\u0142 na grupy i zasoby.\\n3. Mo\u017cliwo\u015b\u0107 poprawiania tag\xf3w tylko na zasobach lub tylko na grupach zasob\xf3w.\\n\\nJak dzia\u0142aj\u0105 skrypty?\\n\\n1. GetAllTags\\n    1. Zapis do pliku odbywa si\u0119 automatycznie do lokalizacji gdzie wykonujemy skrypt lub mo\u017cemy u\u017cy\u0107 opcji -path gdzie maj\u0105 by\u0107 zapisane pliki.\\n    2. Nazwa pliku zawiera dat\u0119, je\u015bli plik istnieje zostanie on nadpisany.\\n    3. Skrypt sprawdza czy jeste\u015b zalogowany do Azure. Podczas wykonywania skryptu mo\u017cesz poda\u0107 parametr -tenantId, aby mie\u0107\xa0pewno\u015b\u0107\xa0\u017ce logujesz si\u0119\xa0do odpowiedniego Azure Directory i -subId w celu wybrania subskrypcji.\\n2. SetTagsResourceGroups oraz SetTagsResources\\n    1. Import danych z plik\xf3w odbywa si\u0119 automatycznie na podstawie konwencji nazewniczej wygenerowanego wcze\u015bniej pliku. Skrypt importuje najnowszy plik CSV we wskazanym katalogu. Istnieje podanie \u015bcie\u017cki poprzez parametr -path.\\n    2. Tagi powinny by\u0107 oddzielone mi\u0119dzy sob\u0105 przecinkami.\\n    3. Tagi zapisane w pliku CSV dzia\u0142aj\u0105 na zasadzie par \u201cKey:Value\u201d w osobnych kolumnach.\\n    4. Skrypt pobiera wszystkie elementy z pliku CSV. Nast\u0119pnie skrypt usuwa tagi w Microsoft Azure nast\u0119pnie wprowadzony z pliku CSV.\\n    5. Je\u015bli nie chcemy danego zasobu rusza\u0107, wystarczy go usun\u0105\u0107 z pliku CSV.\\n    6. Skrypt dzia\u0142a w trybie parallel co pozwala na szybsze wprowadzanie zmian. Throttle dla zapisu tag\xf3w wynosi 5, pami\u0119taj, \u017ce jest to optymalna warto\u015b\u0107.\\n    7. Skrypt sprawdza czy jeste\u015b zalogowany do Azure. Podczas wykonywania skryptu mo\u017cesz poda\u0107 parametr -tenantId.\\n    8. Je\u015bli chcesz wyczy\u015bci\u0107 tagi na zasobach wystarczy \u017ce zostawisz pust\u0105 kom\xf3rk\u0119\xa0lub wpiszesz \u201cempty\u201d.\\n    9. Wprowadzanie tag\xf3w mo\u017cemy testowa\u0107\xa0wprowadzaj\u0105c w pliku CSV tylko ten zas\xf3b kt\xf3ry chcemy zmieni\u0107. Reszta zasob\xf3w nie b\u0119dzie brana pod uwag\u0119\xa0podczas wdra\u017cania tag\xf3w.\\n\\nPoni\u017cej przedstawiam przyk\u0142ad jak to dzia\u0142a na mojej subskrypcji.\\n\\nUruchomienie skryptu:\\n\\n- GetAllTags.ps1\\n\\n`Komenda: ./GetAllTags.ps1 -path /tags`\\n\\n![](https://lh6.googleusercontent.com/g2uknxvVr-r8zuu_JNgHwzMEWXDS_lCkJkvP0w2nsaraF1iUI-PfsBGgFDAMnSqGiPEN-oG5sg0RR5aQWAqnixT1BRO0RBcsIWEpJ48Jfztk-ioLi0NlKg-fFfHPUxjXg60DReVG)\\n\\nNa printscreenie mo\u017cesz zauwa\u017cy\u0107 output z informacjami jakie generowane s\u0105 przez skrypt.\\n\\n- Czy jeste\u015b zalogowany, je\u015bli nie to poprosi Ci\u0119 o zalogowanie si\u0119\\n- Ilo\u015b\u0107\xa0znalezionych grup zasob\xf3w oraz zasob\xf3w\\n- Informacja gdzie i jakie pliki s\u0105\xa0tworzone\\n- Lista zasob\xf3w\\n\\nPliki CSV wygl\u0105daj\u0105 nast\u0119puj\u0105co:\\n\\n- Resource Group\\n\\n![](https://lh3.googleusercontent.com/XiatuhcE3vx4Lr6g5rkz-JP48TjhJ-ydCdwySuAGgBccaVpVZKD9CfPF5xVpIuzU6IFM7PNj939dMpEviYAR3287SCr6F5y2cM4pu1i8500uzKNdRNSh16t8dX9GSosf7J2oDJFa)\\n\\n- Resources\\n\\n![](https://lh4.googleusercontent.com/m5u5NLpGw8DNyroSByMny-rIZsH11sZMs4tgFMixm_Lepfn0rjNf4XqLET6MvsT3YnK48PesD9GJQUkDtWJIuDKsUh7IolWD7BCDfHSQN4Ug_f6qdWpuPF2ns-8vRmnlRNtWptbp)\\n\\nPoni\u017cej przedstawi\u0119 edycj\u0119 tag\xf3w dla pliku z zasobami.\\n\\n_Uwaga! Je\u015bli chcesz zachowa\u0107 kopi\u0119 obecnego stanu, zabezpiecz wygenerowany plik lub zmie\u0144 jego nazw\u0119 na zupe\u0142nie inn\u0105._\xa0\\n\\nPoprawiony plik wygl\u0105da nast\u0119puj\u0105co. Zauwa\u017c, \u017ce wype\u0142ni\u0142em tagi dla wszystkich obiekt\xf3w oraz doda\u0142em nowy tag: Test:Key, aby pokaza\u0107 jak wygl\u0105da przypisywanie wielu tag\xf3w.\\n\\n![](https://lh6.googleusercontent.com/q4_FhHhAden4hD-gq6IJjhVRras8g-lAgwqCo4evhui6_dSF1wjIt6rZwHV23YbOWIuvlJihRbleddX46VkkUudBByLuX_lfGlrab1_U8Ya14-pdg9Xhrqd7hdzoQqpsxwaseZle)\\n\\nWynik skryptu z wykonanymi zmianami:\\n\\n`Komenda: ./SetTagsResources.ps1 -path /tags`\\n\\n![](https://lh4.googleusercontent.com/49zIzivJeCzwtGRSBFcnzG4X0nr3nbtc1dxgJag7q3_tocRbvBcgu0m_DUf11179BBt1GWpHQalOmsyis3CDnEX3xCpgt-1w1Ic_-bR8KFREpnCOP-aXCxmAjefbS7mU7qJbRvkL)\\n\\nEfekt zmian w Portalu Azure:\\n\\n![](https://lh4.googleusercontent.com/O0XGlppGQzJYWYNOJcfKkxTo0ZcT4Hstc46TWolZUIr4Bi80Tq8P60Z1IwlMDgU-vwQ4yLvuj1cYWb9RYy67Z4BDPvFGjx704b9ZYUVbGNb9EFUatChC8Vv3YnHQi4g_1Lr1ciL2)\\n\\nSkrypt mo\u017cna dostosowa\u0107\xa0do swoich cel\xf3w tak, aby dzia\u0142a\u0142 na przyk\u0142ad dla wielu subskrypcji. Jest wiele opcji customizacji tego skryptu, kt\xf3re celowo pomin\u0105\u0142em. Skrypty dzia\u0142aj\u0105 modu\u0142owo wi\u0119c mo\u017cna ich \u0142atwo u\u017cy\u0107 z innym skryptem, a reszta zostanie przygotowana i wdro\u017cona na podstawie wprowadzonych danych z pliku.\\n\\nZapraszam do pozostawienia komentarza!"},{"id":"wyslanie-zadania-api-z-powershell-do-azure-devops","metadata":{"permalink":"/wyslanie-zadania-api-z-powershell-do-azure-devops","source":"@site/blog/2020-04-13-wyslanie-zadania-api-z-powershell-do-azure-devops/index.md","title":"Wys\u0142anie \u017c\u0105dania API z PowerShell do Azure DevOps","description":"PowerShell to nie tylko automatyzacja za pomoc\u0105 modu\u0142\xf3w. Mo\u017cemy go r\xf3wnie\u017c wykorzysta\u0107 do wysy\u0142ania zapyta\u0144 za pomoc\u0105 API do r\xf3\u017cnych serwis\xf3w. W tym artykule zobaczysz jak to zrobi\u0107.","date":"2020-04-13T00:00:00.000Z","formattedDate":"April 13, 2020","tags":[{"label":"api","permalink":"/tags/api"},{"label":"automation","permalink":"/tags/automation"},{"label":"azure","permalink":"/tags/azure"},{"label":"azure devops","permalink":"/tags/azure-devops"},{"label":"powershell","permalink":"/tags/powershell"}],"readingTime":1.405,"truncated":true,"authors":[{"name":"Piotr Rogala","title":"MVP Azure & owner JustCloud.pl","url":"https://github.com/RogalaPiotr","imageURL":"https://avatars.githubusercontent.com/u/31566956?v=4","key":"progala"}],"frontMatter":{"slug":"wyslanie-zadania-api-z-powershell-do-azure-devops","title":"Wys\u0142anie \u017c\u0105dania API z PowerShell do Azure DevOps","description":"PowerShell to nie tylko automatyzacja za pomoc\u0105 modu\u0142\xf3w. Mo\u017cemy go r\xf3wnie\u017c wykorzysta\u0107 do wysy\u0142ania zapyta\u0144 za pomoc\u0105 API do r\xf3\u017cnych serwis\xf3w. W tym artykule zobaczysz jak to zrobi\u0107.","date":"2020-04-13","authors":["progala"],"tags":["api","automation","azure","azure devops","powershell"],"keywords":["justcloud","powershell","api","automatyzacja","automation","azure","microsoft azure","ado","agents"]},"prevItem":{"title":"Przyspieszenie pracy nad tagowaniem zasob\xf3w za pomoc\u0105 PowerShell - Tag raport Microsoft Azure","permalink":"/tags-in-azure"},"nextItem":{"title":"IaC control via PowerShell module for ARM templates","permalink":"/iac-control-via-powershell-module-for-arm-templates"}},"content":"Cz\u0119sto stajemy przed wyzwaniem zintegrowania ze sob\u0105 wielu narz\u0119dzi. Je\u017celi stosujemy PowerShell w celu automatyzacji swojej infrastruktury b\u0105d\u017a budowy prostych skrypt\xf3w mo\u017ce nam si\u0119 przyda\u0107 zastosowanie u\u017cycia wywo\u0142ania \u017c\u0105dania API za pomoc\u0105 PowerShell. Poni\u017cszy przyk\u0142ad zaprezentuje u\u017cycie wys\u0142ania \u017c\u0105dania za pomoc\u0105 API do Azure DevOps w celu dodania puli agentowej.\\n\\nReferencje API do Azure DevOps s\u0105 dost\u0119pne tutaj:\xa0\\n\\n[https://docs.microsoft.com/en-us/rest/api/azure/devops/distributedtask/pools/add?view=azure-devops-rest-5.1](https://docs.microsoft.com/en-us/rest/api/azure/devops/distributedtask/pools/add?view=azure-devops-rest-5.1)\\n\\nPoni\u017cszy przyk\u0142adowy skrypt mo\u017cemy rozbudowa\u0107 dla innych operacji stosuj\u0105c odpowiedni uri dla potrzebnej operacji z powy\u017cszego linku.  \\n\\nNa pocz\u0105tku definiujemy zmienne:  \\n\\n- $urlvsts - URL do naszego projektu Azure DevOps\\n- $token - PAT token (Instrukcja jak wygenerowa\u0107 token: [https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&tabs=preview-page](https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&tabs=preview-page))\\n- $pool - nazwa puli, kt\xf3r\u0105 chcemy utworzy\u0107\\n- $encodedPat - przekonwertowanie tokenu na SecureString\\n- $body - informacje do przekazania w wysy\u0142anym \u017c\u0105daniu\\n\\n\x3c!--truncate--\x3e\\n```\\n$urlvsts = \'https://dev.azure.com/PROJECT-NAME\'\\n$token = \'YOUR-PAT-TOKEN\'\\n$pool = \'YOUR-POOL-NAME\'\\n$encodedPat = [System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes( \\":$token\\"))\\n$body = \\"{name:`\\"$pool`\\", autoProvision: `\\"true`\\"}\\"\\n```\\nKomenda `Invoke-WebRequest` wykonuje wys\u0142ania \u017c\u0105dania podaj\u0105c wcze\u015bniej zdefiniowane zmienne oraz zawiera Uri, czyli miejsce, w kt\xf3re zapuka \u017c\u0105danie, aby ustawi\u0107 now\u0105 pul\u0119 w Azure DevOps.\\n```\\nInvoke-WebRequest `\\n    -Method POST `\\n    -Uri \\"$urlvsts/_apis/distributedtask/pools?api-version=5.0-  preview.1\\" `\\n    -UseBasicParsing `\\n    -Headers @{Authorization = \\"Basic $encodedPat\\"} `\\n    -Body $body `\\n    -ContentType \\"application/json\\"\\n```\\nScreens:\\n\\nCode:\\n\\n![](images/2020-04-13_14h12_09.png)\\n\\nOutput:\\n\\n![](images/2020-04-13_14h12_53.png)\\n\\nAzure DevOps:\\n\\n![](images/2020-04-13_14h14_02-1024x604.png)\\n\\nW prosty spos\xf3b mo\u017cemy teraz zautomatyzowa\u0107 operacje w Azure DevOps bez uruchamiania portalu. Niestety referencje API dla Azure DevOps nie pozwalaj\u0105 na wszystko co mo\u017cemy wyklika\u0107 w portalu, ale na pewno pomo\u017ce to w osi\u0105gni\u0119ciu celu. Je\u015bli masz ciekawe przypadki u\u017cycia wspomnianego API lub zastanawiasz si\u0119, gdzie mo\u017cna tego u\u017cy\u0107 zapraszam do komentowania.\\n\\nU\u017cycie skryptu mo\u017cecie r\xf3wnie\u017c sprawdzi\u0107 w deploymencie puli agent\xf3w dla Azure DevOps tutaj: [https://github.com/RogalaPiotr/JustCloudPublic/blob/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1](https://github.com/RogalaPiotr/JustCloudPublic/blob/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1)\\n\\nArtyku\u0142 dost\u0119pny r\xf3wnie\u017c na Medium i LinkedIN:\\n\\n- (EN) [https://medium.com/@piotr.rogala/api-request-to-azure-devops-from-powershell-2e2f525dbd7a](https://medium.com/@piotr.rogala/api-request-to-azure-devops-from-powershell-2e2f525dbd7a)\\n- (PL) [https://www.linkedin.com/pulse/wys%C5%82anie-%C5%BC%C4%85dania-api-z-powershell-do-azure-devops-piotr-rogala](https://www.linkedin.com/pulse/wys%C5%82anie-%C5%BC%C4%85dania-api-z-powershell-do-azure-devops-piotr-rogala)"},{"id":"iac-control-via-powershell-module-for-arm-templates","metadata":{"permalink":"/iac-control-via-powershell-module-for-arm-templates","source":"@site/blog/2019-09-15-iac-control-via-powershell-module-for-arm-templates/index.md","title":"IaC control via PowerShell module for ARM templates","description":"Walidowanie szablon\xf3w ARM za pomoc\u0105 modu\u0142u PowerShell jest mo\u017cliwe dzi\u0119ki nowemu modu\u0142owi. U\u017cycie tego modu\u0142u pomo\u017ce Ci sprawdzi\u0107 czy szablon jest poprawny i jakie zmiany wprowadzi na wdra\u017canym \u015brodowisku Azure.","date":"2019-09-15T00:00:00.000Z","formattedDate":"September 15, 2019","tags":[{"label":"arm","permalink":"/tags/arm"},{"label":"azure","permalink":"/tags/azure"},{"label":"iac","permalink":"/tags/iac"},{"label":"module","permalink":"/tags/module"},{"label":"powershell","permalink":"/tags/powershell"},{"label":"templates","permalink":"/tags/templates"}],"readingTime":1.69,"truncated":true,"authors":[{"name":"Piotr Rogala","title":"MVP Azure & owner JustCloud.pl","url":"https://github.com/RogalaPiotr","imageURL":"https://avatars.githubusercontent.com/u/31566956?v=4","key":"progala"}],"frontMatter":{"slug":"iac-control-via-powershell-module-for-arm-templates","title":"IaC control via PowerShell module for ARM templates","description":"Walidowanie szablon\xf3w ARM za pomoc\u0105 modu\u0142u PowerShell jest mo\u017cliwe dzi\u0119ki nowemu modu\u0142owi. U\u017cycie tego modu\u0142u pomo\u017ce Ci sprawdzi\u0107 czy szablon jest poprawny i jakie zmiany wprowadzi na wdra\u017canym \u015brodowisku Azure.","authors":["progala"],"date":"2019-09-15","tags":["arm","azure","iac","module","powershell","templates"],"keywords":["justcloud","powershell","arm","template","szablon","automatyzacja","automation","azure","microsoft azure","iac","module"]},"prevItem":{"title":"Wys\u0142anie \u017c\u0105dania API z PowerShell do Azure DevOps","permalink":"/wyslanie-zadania-api-z-powershell-do-azure-devops"},"nextItem":{"title":"Sk\u0105d uczy\u0107 si\u0119 o Microsoft Azure?","permalink":"/skad-uczyc-sie-o-microsoft-azure"}},"content":"Debug natywnych szablon\xf3w ARM jest ci\u0119\u017ckim procesem dla wielu os\xf3b. Utrzymanie infrastruktury jako kod r\xf3wnie\u017c nie jest prost\u0105 spraw\u0105, dlatego cz\u0119sto u\u017cywa si\u0119 Terraforma dla wdro\u017ce\u0144 w Microsoft Azure.\\n\\nSzablony ARM nie posiadaj\u0105 pliku stanu jak to jest w Terraform dlatego cz\u0119sto spotykam si\u0119 z opini\u0105, \u017ce, ARM\'y s\u0105 beznadziejnie. Po wdro\u017ceniu trudno jest utrzyma\u0107 sta\u0142y rozw\xf3j infrastruktury z tego samego szablonu oraz cz\u0119sto problemem jest przewidywalno\u015b\u0107 co si\u0119 stanie z obiektami, kt\xf3re ju\u017c masz. Nie b\u0119d\u0119 si\u0119 rozwodzi\u0142 co lepsze co gorsze, poniewa\u017c wiele zale\u017cy od naszej wiedzy, podej\u015bcia, problemu lub zlecenia, kt\xf3re wykonujemy. Jako In\u017cynier nie przywi\u0105zuje si\u0119 do rozwi\u0105za\u0144 i uwa\u017cam, \u017ce do ka\u017cdego problemu nale\u017cy podchodzi\u0107 indywidualnie. Moim zdaniem najlepsze rozwi\u0105zania to rozwi\u0105zania natywne nie wymagaj\u0105ce tworzenia ko\u0142a na nowo. St\u0105d zach\u0119cam do pisania szablon\xf3w ARM dla Azure.\\n\\nJako pomoc w tworzeniu infrastruktury jako kod (IaC) w Microsoft Azure polecam zapozna\u0107 si\u0119 z modu\u0142em PowerShell: **ARMHelper**\\n\\n[https://www.powershellgallery.com/packages/ARMHelper/0.6.2](https://www.powershellgallery.com/packages/ARMHelper/0.6.2)\\n\\nZa pomoc\u0105 komendy: Test-ARMExistingResource mo\u017cemy zbudowa\u0107 polecenie, kt\xf3re sprawdzi nam wskazany szablon w kontek\u015bcie z deploy\'owanych zasob\xf3w w Azure i wy\u015bwietli co si\u0119 stanie. Przyk\u0142ad poni\u017cej przedstawia stworzon\u0105 resource groupe bez zasob\xf3w:\\n\\nU\u017cy\u0142em szablonu z mojego repo: [https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-shutdown-on-time](https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-shutdown-on-time)  \\nWykonuje kolejno komendy:\\n\\n\x3c!--truncate--\x3e\\n\\nTworzenie nowej resource groupy:\\n\\n`New-AzResourceGroup -Name \'simple-vm-shutdown-on-time\' -Location westeurope`\\n\\nSprawdzenie co wy\u015bwietli poleniecenie Test-ARMExistingResource:\\n\\n`Test-ARMExistingResource -ResourceGroupName \'simple-vm-shutdown-on-time\' -TemplateFile .\\\\azuredeploy.json -TemplateParameterFile .\\\\azuredeploy.parameters.json -Verbose`\\n\\n![](images/2019-09-15_12h46_05.png)\\n\\nWynikiem jest informacja co zostanie utworzone. Super sprawa, to teraz zrobie deployment szablonu i sprawdzimy ponownie.\\n\\n`New-AzResourceGroupDeployment -ResourceGroupName \'simple-vm-shutdown-on-time\' -TemplateFile .\\\\azuredeploy.json -TemplateParameterFile .\\\\azuredeploy.parameters.json -Verbose`\\n\\nNiestety mia\u0142em problem z modu\u0142em Shutdown i szablon wdro\u017cy\u0142 si\u0119 niepoprawnie, dlatego sprawdzi\u0142em co wy\u015bwietli Test-ARMExistResource.\\n\\n`Test-ARMExistingResource -ResourceGroupName \'simple-vm-shutdown-on-time\' -TemplateFile .\\\\azuredeploy.json -TemplateParameterFile .\\\\azuredeploy.parameters.json -Verbose`\\n\\n![](images/2019-09-15_13h01_42.png)\\n\\nJak wida\u0107 polecenie poprawnie zwr\xf3ci\u0142o co jest do poprawienia i co zostanie zmienione(inkrementalnie).\\n\\nOstatni test to z argumentem \\"-Mode Complete\\" czyli wykonanie szablonu, kt\xf3ry dostosuje wszystkie zasoby niezale\u017cnie od tego co jest stworzone w resource groupie do mojego szablonu.\\n\\n`Test-ARMExistingResource -ResourceGroupName \'simple-vm-shutdown-on-time\' -TemplateFile .\\\\azuredeploy.json -TemplateParameterFile .\\\\azuredeploy.parameters.json -Verbose -Mode Complete`\\n\\n![](images/2019-09-15_13h02_32.png)\\n\\nTeraz mo\u017cna by\u0107 pewniejszym co si\u0119 stanie z wdro\u017ceniem po ma\u0142ych zmianach w szablonie.\\n\\n\\nMam nadzieje \u017ce przyda Ci si\u0119 ta wiedza :)"},{"id":"skad-uczyc-sie-o-microsoft-azure","metadata":{"permalink":"/skad-uczyc-sie-o-microsoft-azure","source":"@site/blog/2018-11-18-skad-uczyc-sie-o-microsoft-azure/index.md","title":"Sk\u0105d uczy\u0107 si\u0119 o Microsoft Azure?","description":"Chcesz zacz\u0105\u0107 nauke o Microsoft Azure? W tym artykule znajdziesz linki, kt\xf3re napewno Ci\u0119 zainteresuj\u0105!","date":"2018-11-18T00:00:00.000Z","formattedDate":"November 18, 2018","tags":[{"label":"azure","permalink":"/tags/azure"},{"label":"course","permalink":"/tags/course"},{"label":"courses","permalink":"/tags/courses"},{"label":"kurs","permalink":"/tags/kurs"},{"label":"kursy","permalink":"/tags/kursy"},{"label":"learn","permalink":"/tags/learn"},{"label":"microsoft azure","permalink":"/tags/microsoft-azure"},{"label":"nauka","permalink":"/tags/nauka"}],"readingTime":1.075,"truncated":true,"authors":[{"name":"Piotr Rogala","title":"MVP Azure & owner JustCloud.pl","url":"https://github.com/RogalaPiotr","imageURL":"https://avatars.githubusercontent.com/u/31566956?v=4","key":"progala"}],"frontMatter":{"slug":"skad-uczyc-sie-o-microsoft-azure","title":"Sk\u0105d uczy\u0107 si\u0119 o Microsoft Azure?","description":"Chcesz zacz\u0105\u0107 nauke o Microsoft Azure? W tym artykule znajdziesz linki, kt\xf3re napewno Ci\u0119 zainteresuj\u0105!","authors":["progala"],"date":"2018-11-18","tags":["azure","course","courses","kurs","kursy","learn","microsoft azure","nauka"],"keywords":["justcloud","nauka","azure","microsoft azure","devops"]},"prevItem":{"title":"IaC control via PowerShell module for ARM templates","permalink":"/iac-control-via-powershell-module-for-arm-templates"},"nextItem":{"title":"Auto deployment VM with VSTS agent for pool","permalink":"/auto-deployment-vm-with-vsts-agent-for-pool"}},"content":"Po ostatniej prezentacji naszed\u0142 mnie pomys\u0142 zwi\u0105zany z utworzeniem miejsca sk\u0105d mo\u017cna si\u0119 uczy\u0107 chmury Microsoft Azure. St\u0105d postanowi\u0142em zebra\u0107 interesuj\u0105ce linki w jednym miejscu gdzie znajdziecie rekomendowane przeze mnie jak i przez innych ekspert\xf3w miejsca do nauki. Wi\u0119kszo\u015b\u0107 z poni\u017cszych link\xf3w jest darmowa i takie b\u0119d\u0119 stara\u0142 si\u0119 udost\u0119pnia\u0107. Je\u015bli chcia\u0142by\u015b doda\u0107 ciekawe miejsce, kt\xf3re rekomendujesz dodaj je w komentarzu, pomo\u017ce to w udoskonaleniu listy.\\n\\nJe\u015bli wiesz czego konkretnie szukasz mo\u017cesz u\u017cy\u0107 wyszukiwarki aby skoncentrowa\u0107 si\u0119 na danym problemie: \\n\\n[![](https://img.youtube.com/vi/Rkxg03z2PEo/0.jpg)](https://www.youtube.com/watch?v=Rkxg03z2PEo)\\n\\n\x3c!--truncate--\x3e\\n\\nA, tak na powa\u017cnie mo\u017cesz zaczerpn\u0105\u0107 wiedzy w poni\u017cszych miejscach.\\n\\nGrupa Microsoft Azure User Group Poland na Facebook\'u:\xa0[https://www.facebook.com/groups/azureugpl/](https://www.facebook.com/groups/azureugpl/)\\n\\n**Video:**\\n\\n- Azure Developer:\xa0[https://docs.microsoft.com/pl-pl/learn/browse/?roles=developer&products=azure](https://docs.microsoft.com/pl-pl/learn/browse/?roles=developer&products=azure)\\n- Azure Administrator:\xa0[https://docs.microsoft.com/pl-pl/learn/browse/?roles=administrator&products=azure](https://docs.microsoft.com/pl-pl/learn/browse/?roles=administrator&products=azure)\\n- Azure Solution Architect:\xa0[https://docs.microsoft.com/pl-pl/learn/browse/?roles=solution-architect&products=azure](https://docs.microsoft.com/pl-pl/learn/browse/?roles=solution-architect&products=azure)\\n- Azure Friday:\xa0[https://channel9.msdn.com/Shows/Azure-Friday](https://channel9.msdn.com/Shows/Azure-Friday)\\n- Microsoft Self-paced Labs:\xa0[https://www.microsoft.com/handsonlabs/selfpacedlabs](https://www.microsoft.com/handsonlabs/selfpacedlabs)\\n- Microsoft Virtual Academy:\xa0[https://mva.microsoft.com/search/SearchResults.aspx#!q=azure&orderby=publishedtime&lang=1033](https://mva.microsoft.com/search/SearchResults.aspx#!q=azure&orderby=publishedtime&lang=1033)\\n- Azure Tips and Tricks:\xa0[https://www.michaelcrump.net/azure-tips-and-tricks-complete-list/](https://www.michaelcrump.net/azure-tips-and-tricks-complete-list/)\\n- Pluralsight:\xa0[https://www.pluralsight.com/search?q=azure](https://www.pluralsight.com/search?q=azure)\\n\\n**Blogi\xa0Polskich ekspert\xf3w:**\\n\\n- Micha\u0142 Furmankiewicz: [http://cloudarchitects.pl/](http://cloudarchitects.pl/)\\n- Micha\u0142 Smereczy\u0144ski: [https://lnx.azurewebsites.net/](https://lnx.azurewebsites.net/)\\n- Emil Wasilewski:\xa0[http://zapytajemila.pl/](http://zapytajemila.pl/)\\n- \u0141ukasz Ka\u0142u\u017cny:\xa0[https://kaluzny.io/](https://kaluzny.io/)\\n- Sebastian Fyda:\xa0[http://blog.spiderweb.pl/](http://blog.spiderweb.pl/)\\n- Piotr Rogala:\xa0[https://justcloud.azurewebsites.net/blog/](https://justcloud.azurewebsites.net/blog/)\\n- Szymon Pulka (DEV):\xa0[https://devincloud.pl/](https://devincloud.pl/)\\n- Mateusz Dudek (DEV):\xa0[https://mateuszdudek.pl/blog/](https://mateuszdudek.pl/blog/)\\n\\n**Book\'s**\\n\\n- Free eBooks from Microsoft Press\\n    - Microsoft Azure Essentials: Fundamentals of Azure, Second Edition\\n    - Introduction to Windows Containers\\n    - Microsoft Azure Essentials Migrating SQL Server Databases to Azure\\n    - Microsoft Azure Essentials: Azure Web Apps for Developers\\n- The Developer\u2019s Guide to Microsoft Azure:\xa0[https://azure.microsoft.com/en-us/blog/free-ebook-the-developer-s-guide-to-microsoft-azure-now-available/](https://azure.microsoft.com/en-us/blog/free-ebook-the-developer-s-guide-to-microsoft-azure-now-available/)\\n\\n**Certyfikaty:**\\n\\n- Lista mo\u017cliwych certyfikat\xf3w do zrobienia dot. Azure:\xa0[https://www.microsoft.com/en-us/learning/azure-exams.aspx](https://www.microsoft.com/en-us/learning/azure-exams.aspx)"},{"id":"auto-deployment-vm-with-vsts-agent-for-pool","metadata":{"permalink":"/auto-deployment-vm-with-vsts-agent-for-pool","source":"@site/blog/2018-05-27-auto-deployment-vm-with-vsts-agent-for-pool/index.md","title":"Auto deployment VM with VSTS agent for pool","description":"Azure DevOps agent to wa\u017cny element wszystkich wdro\u017ce\u0144. Potrzebujesz stworzy\u0107 w\u0142asnego agenta ADO? Zobacz jak to zrobi\u0107 w prosty i automatyczny spos\xf3b! Wszystko znajdziesz we wpisie.","date":"2018-05-27T00:00:00.000Z","formattedDate":"May 27, 2018","tags":[{"label":"arm","permalink":"/tags/arm"},{"label":"automation","permalink":"/tags/automation"},{"label":"azure","permalink":"/tags/azure"},{"label":"deplyoment","permalink":"/tags/deplyoment"},{"label":"json","permalink":"/tags/json"},{"label":"microsoft","permalink":"/tags/microsoft"},{"label":"vsts","permalink":"/tags/vsts"},{"label":"ado","permalink":"/tags/ado"}],"readingTime":6.94,"truncated":true,"authors":[{"name":"Piotr Rogala","title":"MVP Azure & owner JustCloud.pl","url":"https://github.com/RogalaPiotr","imageURL":"https://avatars.githubusercontent.com/u/31566956?v=4","key":"progala"}],"frontMatter":{"slug":"auto-deployment-vm-with-vsts-agent-for-pool","title":"Auto deployment VM with VSTS agent for pool","description":"Azure DevOps agent to wa\u017cny element wszystkich wdro\u017ce\u0144. Potrzebujesz stworzy\u0107 w\u0142asnego agenta ADO? Zobacz jak to zrobi\u0107 w prosty i automatyczny spos\xf3b! Wszystko znajdziesz we wpisie.","authors":["progala"],"date":"2018-05-27","tags":["arm","automation","azure","deplyoment","json","microsoft","vsts","ado"],"keywords":["justcloud","ado","azure","microsoft azure","devops","agent","pipelines","deployment","azure devops agents"],"hide_table_of_contents":true},"prevItem":{"title":"Sk\u0105d uczy\u0107 si\u0119 o Microsoft Azure?","permalink":"/skad-uczyc-sie-o-microsoft-azure"}},"content":"Wszyscy kt\xf3ry robi\u0105 depyolemnty z VSTS spotykaj\u0105 si\u0119 z sytuacj\u0105, kiedy standardowe 240min si\u0119 ko\u0144czy i trzeba stworzy\u0107 sobie tak\u0105 maszyn\u0119. Sam robi\u0142em tak\u0105 maszyn\u0119 par\u0119 razy i kiedy zn\xf3w pojawi\u0142a si\u0119 ta konieczno\u015b\u0107 postanowi\u0142em stworzy\u0107 automatyczny deployment kt\xf3ry nam stworzy z JSON\'a ca\u0142a maszynk\u0119 i podepnie j\u0105 do Agent pool w VSTS.\\n\\nMia\u0142em par\u0119 pomys\u0142\xf3w, aby zrobi\u0107 bardzo uniwersalny template kt\xf3ry nie tylko przyda si\u0119 wam, ale r\xf3wnie\u017c mi w przysz\u0142o\u015bci do budowania innych szablon\xf3w. Tak\u017ce w skr\xf3cie opisz\u0119 ciekawostki kt\xf3re zastosowa\u0142em szablonie, kt\xf3ry znajdziecie na moim GitHubie.\\n\\n##### **GitHub**:\xa0[https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-with-installation-vsts-agent](https://github.com/RogalaPiotr/JustCloudPublic/tree/master/simple-vm-with-installation-vsts-agent)\\n\\nZa\u0142o\u017cenie dotycz\u0105ce szablonu: chcia\u0142bym doda\u0107 informacj\u0119, gdzie wa\u017cnym jest zwr\xf3cenie uwagi, \u017ce maszyna ma by\u0107 odizolowana od naszej sieci wewn\u0119trznej, dlatego szablon jest infrastruktura stand alone, aby by\u0142o bezpiecznie i w razie czego mo\u017cna j\u0105 usun\u0105 lub powo\u0142a\u0107 wi\u0119cej agent\xf3w do deployment\u2019\xf3w.\\n\\n\x3c!--truncate--\x3e\\n\\n# Opis szablonu\\n\\n## **Sekcja Parameters:**\\n\\nw tej sekcji podajemy dane kt\xf3re przydadz\u0105 nam si\u0119 do deplyment\u2019u i automatycznego pod\u0142\u0105czenia do VSTS\'a.\\n\\n- **adminUsername**, **adminPassword** - lokalny u\u017cytkownik i has\u0142o,\\n- **dnsLabelPrefix** - zostanie automatycznie wygenerowany podczas deployment\u2019u, wi\u0119c nie ma konieczno\u015bci go zmienia\u0107,\\n- **vmName** - nazwa naszej maszyny oraz na podstawie tej nazwy zostan\u0105 nazwane wszystkie nasze resource jest: VNET, NSG, Storage...\\n- **urlvsts** - adres do naszego projektu VSTS np.: https://project1.visualstudio.com,\\n- **auth** - rodzaj po\u015bwiadczenia - wybrany domy\u015blnie PAT,\\n- **token** - token security kt\xf3ry umo\u017cliwi nam pod\u0142\u0105czenie si\u0119 do projektu. Wi\u0119cej informacji jak stworzy\u0107 Security Token poni\u017cej:\\n    - [**https://docs.microsoft.com/en-us/vsts/build-release/actions/agents/v2-windows?view=vsts**](https://docs.microsoft.com/en-us/vsts/build-release/actions/agents/v2-windows?view=vsts)\\n- **pool** - nazwa puli, do kt\xf3rej zostanie dodana maszyna w VSTS\'ie - ustawiony jest na default\\n- **AccessIPNSG** - adres, kt\xf3ry tutaj podacie zostanie dodany do NSG i tylko z tego adresu dostaniecie si\u0119 po RDP do maszyny,\\n- **Tag** - tagi mog\u0105 ulec waszej modyfikacji ustawione s\u0105 na Project: VSTSAgent.\\n\\n## **Sekcja Variables:**\\n\\n- **vmsize** - ustawiony na \\"Standard\\\\_B1s\\" - dosy\u0107 tani i wystarczaj\u0105cy na maszyn\u0119 deployment\u2019owy - pami\u0119taj, aby sprawdzi\u0107, czy masz mo\u017cliwo\u015b\u0107 deploy\u2019owania tej maszyny w swojej subskrypcji w innym przypadku zg\u0142o\u015b request do supportu Microsoft w celu uruchomienia wielko\u015bci B\\\\_size.\\n- **urldonwloadagent** - w tym miejscu jest podany link do \u015bci\u0105gni\u0119cia aktualnego zip\'a z agentem VSTS - w razie zmiany wersji nale\u017cy zaktualizowa\u0107 link na aktualny\\n- **filescriptURI** - skrypt napisany przeze mnie w celu automatycznego pobrania i zainstalowania agenta na maszynie:\xa0https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1\\n- **filescriptURISplit** - bardzo ciekawa funkcja, kt\xf3ra rozbija powy\u017cszy url na tekst tam, gdzie jest slah \\"/\\" co w efekcie generuje nam obiekt\\n    - wi\u0119cej ciekawych informacji w dokumentacji Microsoft:\xa0**[https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-template-functions](https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-template-functions)**\\n- **filescriptName** - kolejna fajna funkcja, gdzie na podstawie powy\u017cszego splita zabieramy nazw\u0119 skryptu, kt\xf3ry pos\u0142u\u017cy nam do instalacji w CustomScriptExtension,\\n- **agentname** - ka\u017cdy dodany Agent do puli w VSTS b\u0119dzie nosi\u0142 nazw\u0119 NazwaMaszynyagent.\\n\\n## **Sekcja Resources:**\\n\\n- **type: Microsoft.Network/networkSecurityGroups** - NSG z dost\u0119pem RDP tylko z adresu IP kt\xf3ry dodamy podczas deploy\u2019mentu parametr: AccessIPNSG\\n- **type: Microsoft.Network/publicIPAddresses** - Publiczny adres dla naszej VM, aby m\xf3c si\u0119 do niej pod\u0142\u0105czy\u0107 z zewn\u0105trz.\\n- **type: Microsoft.Network/virtualNetworks** - VNet\\n- **type: Microsoft.Compute/virtualMachines** - tworzenie maszyny wirtualnej z Windows 2016 i Managed Disk\\n    - **type: Microsoft.Compute/virtualMachines/extensions** - instalacja agenta VSTS, bazuj\u0105c na napisanym skrypcie i udost\u0119pnionym na GitHubie:\xa0vstsagent.ps1 zostanie on u\u017cyty podczas deplyoment\u2019u a podczas jego wykonywaniu dodamy informacj\u0119 zwi\u0105zane z url VSTS, tokenem itp. Pe\u0142na komenda w linii 257: \\"commandToExecute\\"\\n- **type: Microsoft.DevTestLab/schedules** - dzi\u0119ki temu nasza maszynie b\u0119dzie wy\u0142\u0105czana codziennie o 18:00 zona: W. Europe Standard Time - ten feature dzia\u0142a tylko kiedy maszyna jest w\u0142\u0105czona pozwoli to nam zapomnie\u0107 o wy\u0142\u0105czaniu, a mimo wszystko nie b\u0119dziemy traci\u0107 pieni\u0119dzy za jej bezczynno\u015b\u0107.\\n\\n## **Sekcja Outputs:**\\n\\n- **PublicDNS** - po wykonaniu deployment\u2019u wy\u015bwietli nam publiczny adres DNS dla VM,\\n- **Hostname** - wy\u015bwietli nazw\u0119 maszyny, kt\xf3r\u0105 wprowadzili\u015bmy w parametrach,\\n- **VSTSAgentName** - wy\u015bwietli nazw\u0119 agenta jaka b\u0119dzie widoczna w VSTS,\\n- **VSTSProjectName** - wy\u015bwietli nazw\u0119 projektu VSTS jaki zosta\u0142 wprowadzony,\\n- **ScriptURI** - wy\u015bwietli \u017ar\xf3d\u0142o z jakiego zosta\u0142 pobrany skrypt do instalacji Agenta,\\n- **AccessRDPFrom** - wy\u015bwietli adres IP kt\xf3ry zosta\u0142 dodany do NSG, aby mia\u0142 dost\u0119p do RDP\\n\\n# Szablon:\\n```\\n{\\n  \\"$schema\\": \\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\\",\\n  \\"contentVersion\\": \\"1.0.0.0\\",\\n  \\"parameters\\": {\\n    \\"adminUsername\\": {\\n      \\"type\\": \\"string\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Username for the Virtual Machine.\\"\\n      }\\n    },\\n    \\"adminPassword\\": {\\n      \\"type\\": \\"securestring\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Password for the Virtual Machine.\\"\\n      }\\n    },\\n    \\"dnsLabelPrefix\\": {\\n      \\"type\\": \\"string\\",\\n      \\"defaultValue\\": \\"[concat(\'x\', uniqueString(resourceGroup().id))]\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Unique DNS Name for the Public IP used to access the Virtual Machine.\\"\\n      }\\n    },\\n    \\"vmName\\": {\\n      \\"type\\": \\"string\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Unique DNS Name for the Public IP used to access the Virtual Machine.\\"\\n      }\\n    },\\n    \\"urlvsts\\": {\\n      \\"type\\": \\"string\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"URL for your VSTS Project ex. https://project1.visualstudio.com.\\"\\n      }\\n    },\\n    \\"auth\\": {\\n      \\"type\\": \\"string\\",\\n      \\"defaultValue\\": \\"pat\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Unique DNS Name for the Public IP used to access the Virtual Machine.\\"\\n      }\\n    },\\n    \\"token\\": {\\n      \\"type\\": \\"securestring\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Security token for VSTS project.\\"\\n      }\\n    },\\n    \\"pool\\": {\\n      \\"type\\": \\"string\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Pool name in VSTS - Default is a main.\\"\\n      }\\n    },\\n    \\"AccessIPNSG\\": {\\n      \\"type\\": \\"string\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Your publif IP it will added for NSG for connection via RDP.\\"\\n      }\\n    },\\n    \\"numberagents\\": {\\n      \\"type\\": \\"int\\",\\n      \\"metadata\\": {\\n        \\"description\\": \\"Numbers of agents for installation\\"\\n      }\\n    },\\n    \\"tag\\": {\\n      \\"type\\": \\"string\\",\\n      \\"metadata\\": {\\n          \\"description\\": \\"Tag Values\\"\\n      }\\n  }\\n},\\n  \\"variables\\": {\\n    \\"storageAccountName\\": \\"[concat(\'stor\', uniquestring(resourceGroup().id))]\\",\\n    \\"windowsOSVersion\\": \\"2019-Datacenter\\",\\n    \\"vmsize\\": \\"Standard_B2ms\\",\\n    \\"publicIPAddressName\\": \\"[concat(parameters(\'vmName\'), \'-pip\')]\\",\\n    \\"virtualNetworkName\\": \\"[concat(parameters(\'vmName\'), \'-vnet\')]\\",\\n    \\"NSGname\\": \\"[concat(parameters(\'vmName\'), \'-nsg\')]\\",\\n    \\"nicName\\": \\"[concat(parameters(\'vmName\'), \'-nic\')]\\",\\n    \\"subnetName\\": \\"[concat(parameters(\'vmName\'), \'-subnet\')]\\",\\n    \\"addressPrefix\\": \\"10.0.0.0/16\\",\\n    \\"subnetPrefix\\": \\"10.0.0.0/24\\",\\n    \\"subnetRef\\": \\"[resourceId(\'Microsoft.Network/virtualNetworks/subnets\', variables(\'virtualNetworkName\'), variables(\'subnetName\'))]\\",\\n    \\"urldonwloadagent\\": \\"https://vstsagentpackage.azureedge.net/agent/2.155.1/vsts-agent-win-x64-2.155.1.zip\\",\\n    \\"filescriptURI\\": \\"https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/vstsagent.ps1\\",\\n    \\"filescriptURISplit\\": \\"[split(variables(\'filescriptURI\'), \'/\')]\\",\\n    \\"filescriptName\\": \\"[last(variables(\'filescriptURISplit\'))]\\",\\n    \\"agentname\\": \\"[parameters(\'vmName\')]\\"\\n  },\\n  \\"resources\\": [\\n    {\\n      \\"type\\": \\"Microsoft.Storage/storageAccounts\\",\\n      \\"name\\": \\"[variables(\'storageAccountName\')]\\",\\n      \\"apiVersion\\": \\"2015-06-15\\",\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"properties\\": {\\n        \\"accountType\\": \\"Standard_LRS\\"\\n      }\\n    },\\n    {\\n      \\"type\\": \\"Microsoft.Network/networkSecurityGroups\\",\\n      \\"name\\": \\"[variables(\'NSGName\')]\\",\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"apiVersion\\": \\"2018-03-01\\",\\n      \\"properties\\": {\\n        \\"securityRules\\": [\\n          {\\n            \\"name\\": \\"RDP\\",\\n            \\"properties\\": {\\n              \\"description\\": \\"Allow IP for RDP\\",\\n              \\"protocol\\": \\"TCP\\",\\n              \\"sourcePortRange\\": \\"*\\",\\n              \\"destinationPortRange\\": \\"3389\\",\\n              \\"sourceAddressPrefix\\": \\"[parameters(\'AccessIPNSG\')]\\",\\n              \\"destinationAddressPrefix\\": \\"*\\",\\n              \\"access\\": \\"Allow\\",\\n              \\"priority\\": 100,\\n              \\"direction\\": \\"Inbound\\"\\n            }\\n          }\\n        ]\\n      }\\n    },\\n    {\\n      \\"apiVersion\\": \\"2016-03-30\\",\\n      \\"type\\": \\"Microsoft.Network/publicIPAddresses\\",\\n      \\"name\\": \\"[variables(\'publicIPAddressName\')]\\",\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"properties\\": {\\n        \\"publicIPAllocationMethod\\": \\"Dynamic\\",\\n        \\"dnsSettings\\": {\\n          \\"domainNameLabel\\": \\"[parameters(\'dnsLabelPrefix\')]\\"\\n        }\\n      }\\n    },\\n    {\\n      \\"apiVersion\\": \\"2016-03-30\\",\\n      \\"type\\": \\"Microsoft.Network/virtualNetworks\\",\\n      \\"name\\": \\"[variables(\'virtualNetworkName\')]\\",\\n      \\"dependsOn\\": [\\n        \\"[resourceId(\'Microsoft.Network/networkSecurityGroups/\', variables(\'NSGName\'))]\\"\\n      ],\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"properties\\": {\\n        \\"addressSpace\\": {\\n          \\"addressPrefixes\\": [\\n            \\"[variables(\'addressPrefix\')]\\"\\n          ]\\n        },\\n        \\"subnets\\": [\\n          {\\n            \\"name\\": \\"[variables(\'subnetName\')]\\",\\n            \\"properties\\": {\\n              \\"addressPrefix\\": \\"[variables(\'subnetPrefix\')]\\",\\n              \\"networkSecurityGroup\\": {\\n                \\"id\\": \\"[resourceId(\'Microsoft.Network/networkSecurityGroups\',variables(\'NSGName\'))]\\"\\n            }\\n            }\\n          }\\n        ]\\n      }\\n    },\\n    {\\n      \\"apiVersion\\": \\"2016-03-30\\",\\n      \\"type\\": \\"Microsoft.Network/networkInterfaces\\",\\n      \\"name\\": \\"[variables(\'nicName\')]\\",\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"dependsOn\\": [\\n        \\"[resourceId(\'Microsoft.Network/publicIPAddresses/\', variables(\'publicIPAddressName\'))]\\",\\n        \\"[resourceId(\'Microsoft.Network/virtualNetworks/\', variables(\'virtualNetworkName\'))]\\"\\n      ],\\n      \\"properties\\": {\\n        \\"ipConfigurations\\": [\\n          {\\n            \\"name\\": \\"ipconfig1\\",\\n            \\"properties\\": {\\n              \\"privateIPAllocationMethod\\": \\"Dynamic\\",\\n              \\"publicIPAddress\\": {\\n                \\"id\\": \\"[resourceId(\'Microsoft.Network/publicIPAddresses\',variables(\'publicIPAddressName\'))]\\"\\n              },\\n              \\"subnet\\": {\\n                \\"id\\": \\"[variables(\'subnetRef\')]\\"\\n              }\\n            }\\n          }\\n        ]\\n      }\\n    },\\n    {\\n      \\"apiVersion\\": \\"2016-04-30-preview\\",\\n      \\"type\\": \\"Microsoft.Compute/virtualMachines\\",\\n      \\"name\\": \\"[parameters(\'vmName\')]\\",\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"dependsOn\\": [\\n        \\"[resourceId(\'Microsoft.Network/networkInterfaces/\', variables(\'nicName\'))]\\",\\n        \\"[concat(\'Microsoft.Storage/storageAccounts/\', variables(\'storageAccountName\'))]\\"\\n      ],\\n      \\"properties\\": {\\n        \\"licenseType\\": \\"Windows_Server\\",\\n        \\"hardwareProfile\\": {\\n          \\"vmSize\\": \\"[variables(\'vmsize\')]\\"\\n        },\\n        \\"osProfile\\": {\\n          \\"computerName\\": \\"[parameters(\'vmName\')]\\",\\n          \\"adminUsername\\": \\"[parameters(\'adminUsername\')]\\",\\n          \\"adminPassword\\": \\"[parameters(\'adminPassword\')]\\"\\n        },\\n        \\"storageProfile\\": {\\n          \\"imageReference\\": {\\n            \\"publisher\\": \\"MicrosoftWindowsServer\\",\\n            \\"offer\\": \\"WindowsServer\\",\\n            \\"sku\\": \\"[variables(\'windowsOSVersion\')]\\",\\n            \\"version\\": \\"latest\\"\\n          },\\n          \\"osDisk\\": {\\n            \\"name\\": \\"[concat(parameters(\'vmName\'),\'-os\')]\\",\\n            \\"vhd\\": {\\n              \\"uri\\": \\"[concat(\'http://\',variables(\'storageAccountName\'),\'.blob.core.windows.net/vhds/\',parameters(\'vmName\'),\'-vm-os.vhd\')]\\"\\n            },\\n            \\"caching\\": \\"ReadWrite\\",\\n            \\"createOption\\": \\"FromImage\\"\\n          }\\n        },\\n        \\"networkProfile\\": {\\n          \\"networkInterfaces\\": [\\n            {\\n              \\"id\\": \\"[resourceId(\'Microsoft.Network/networkInterfaces\',variables(\'nicName\'))]\\"\\n            }\\n          ]\\n        }\\n      },\\n      \\"resources\\": [\\n        {\\n          \\"name\\": \\"[concat(parameters(\'vmName\'),\'/AzureDevOpsAgentInstall\')]\\",\\n          \\"type\\": \\"Microsoft.Compute/virtualMachines/extensions\\",\\n          \\"location\\": \\"[resourceGroup().location]\\",\\n          \\"tags\\": {\\n            \\"Project\\": \\"[parameters(\'tag\')]\\"\\n          },\\n          \\"dependsOn\\": [\\n            \\"[concat(\'Microsoft.Compute/virtualMachines/\', parameters(\'vmName\'))]\\"\\n          ],\\n          \\"apiVersion\\": \\"2015-06-15\\",\\n          \\"properties\\": {\\n            \\"publisher\\": \\"Microsoft.Compute\\",\\n            \\"type\\": \\"CustomScriptExtension\\",\\n            \\"typeHandlerVersion\\": \\"1.9\\",\\n            \\"autoUpgradeMinorVersion\\": true,\\n            \\"settings\\": {\\n              \\"fileUris\\": [\\n                \\"[variables(\'filescriptURI\')]\\"\\n                ]\\n            },\\n            \\"protectedSettings\\": {\\n              \\"commandToExecute\\": \\"[concat(\'powershell -ExecutionPolicy Unrestricted -File \',variables(\'filescriptName\'),\' -url \',variables(\'urldonwloadagent\'),\' -urlvsts \',parameters(\'urlvsts\'),\' -auth \',parameters(\'auth\'),\' -token \',parameters(\'token\'),\' -pool \',parameters(\'pool\'),\' -agentname \',variables(\'agentname\'), \' -numberagents \',parameters(\'numberagents\'))]\\"\\n            }\\n          }\\n        }\\n      ]\\n    },\\n    {\\n      \\"apiVersion\\": \\"2016-05-15\\",\\n      \\"type\\": \\"Microsoft.DevTestLab/schedules\\",\\n      \\"name\\": \\"[concat(\'shutdown-computevm-\', parameters(\'vmName\'))]\\",\\n      \\"location\\": \\"[resourceGroup().location]\\",\\n      \\"tags\\": {\\n        \\"Project\\": \\"[parameters(\'tag\')]\\"\\n      },\\n      \\"dependsOn\\": [\\n        \\"[resourceId(\'Microsoft.Compute/virtualMachines/\', parameters(\'vmName\'))]\\"\\n      ],\\n      \\"properties\\": {\\n        \\"status\\":\\"Enabled\\",\\n        \\"timeZoneId\\":\\"W. Europe Standard Time\\",\\n        \\"taskType\\":\\"ComputeVmShutdownTask\\",\\n        \\"notificationSettings\\":{\\n          \\"status\\":\\"Disabled\\",\\n          \\"timeInMinutes\\":15,\\n          \\"webhookUrl\\":null\\n        },\\n        \\"targetResourceId\\":\\"[resourceId(\'Microsoft.Compute/virtualMachines\', parameters(\'vmName\'))]\\",\\n        \\"dailyRecurrence\\":{\\n          \\"time\\":\\"1800\\"\\n        }\\n      }\\n    }\\n  ],\\n  \\"outputs\\": {\\n    \\"PublicDNS\\": {\\n      \\"type\\" : \\"string\\",\\n      \\"value\\": \\"[reference(variables(\'publicIPAddressName\')).dnsSettings.fqdn]\\"\\n    },\\n    \\"HostName\\": {\\n      \\"type\\" : \\"string\\",\\n      \\"value\\": \\"[parameters(\'vmName\')]\\"\\n    },\\n    \\"VSTSAgentName\\": {\\n      \\"type\\" : \\"string\\",\\n      \\"value\\": \\"[variables(\'agentname\')]\\"\\n    },  \\n    \\"VSTSProjectName\\": {\\n      \\"type\\" : \\"string\\",\\n      \\"value\\": \\"[parameters(\'urlvsts\')]\\"\\n    },  \\n    \\"ScritpURI\\": {\\n      \\"type\\" : \\"string\\",\\n      \\"value\\": \\"[variables(\'filescriptURI\')]\\"\\n    },\\n    \\"AccessRDPFrom\\": {\\n      \\"type\\" : \\"string\\",\\n      \\"value\\": \\"[parameters(\'accessIPNSG\')]\\"\\n    }\\n  }\\n}\\n```\\n\\n# **Przyk\u0142ad:**\\n\\n### **Aby wykona\u0107 deployment nale\u017cy utworzy\u0107 Resource Group\'\u0119:**\\n\\n`New-AzureRMResourceGroup -Name VSTS -Location westeurope`\\n\\n### **Wykonanie deployment\u2019u:**\\n\\n`New-AzureRMResourceGroupDeployment -ResourceGroupName VSTS -TemplateURI \\"https://raw.githubusercontent.com/RogalaPiotr/JustCloudPublic/master/simple-vm-with-installation-vsts-agent/azuredeploy.json\\" -Verbose`\\n\\n**Efekt w portalu po deploy\u2019mencie:**\\n\\n[![](images/Clipboard21.jpg)](images/Clipboard21.jpg)\\n\\n**Widok puli agent\xf3w w VSTS:**\\n\\n[![](images/Clipboard22.jpg)](images/Clipboard22.jpg)\\n\\nMaszyna jest gotowa do deploy\u2019ment\xf3w, je\u015bli potrzebujesz wi\u0119cej maszyn mo\u017cesz bez oporu deploy\u2019owa\u0107 wi\u0119ksz\u0105 ilo\u015b\u0107 :)\\n\\nCzas deplymentu to: 15 minutes 46 seconds."}]}')}}]);