"use strict";(self.webpackChunkjustcloudblog=self.webpackChunkjustcloudblog||[]).push([[5398],{3905:function(e,a,t){t.d(a,{Zo:function(){return z},kt:function(){return m}});var r=t(7294);function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function n(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){o(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,r,o=function(e,a){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),p=function(e){var a=r.useContext(c),t=a;return e&&(t="function"==typeof e?e(a):n(n({},a),e)),t},z=function(e){var a=p(e.components);return r.createElement(c.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},l=r.forwardRef((function(e,a){var t=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,z=s(e,["components","mdxType","originalType","parentName"]),l=p(t),m=o,d=l["".concat(c,".").concat(m)]||l[m]||u[m]||i;return t?r.createElement(d,n(n({ref:a},z),{},{components:t})):r.createElement(d,n({ref:a},z))}));function m(e,a){var t=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var i=t.length,n=new Array(i);n[0]=l;var s={};for(var c in a)hasOwnProperty.call(a,c)&&(s[c]=a[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,n[1]=s;for(var p=2;p<i;p++)n[p]=t[p];return r.createElement.apply(null,n)}return r.createElement.apply(null,t)}l.displayName="MDXCreateElement"},501:function(e,a,t){t.r(a),t.d(a,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},assets:function(){return z},toc:function(){return u},default:function(){return m}});var r=t(7462),o=t(3366),i=(t(7294),t(3905)),n=["components"],s={slug:"migration-database-sql-to-azure-2",title:"Migracja bazy SQL do Azure - Migration database SQL to Azure",description:"Migracja bazy Microsoft SQL do Azure SQL krok po kroku.",authors:["progala"],date:"2013-08-14",tags:["azure","codeplex","database","migration","sql","sql-services"],keywords:["azure","codeplex","database","migration","sql","sql-services"],hide_table_of_contents:!0},c=void 0,p={permalink:"/migration-database-sql-to-azure-2",source:"@site/blog/2013-08-14-migration-database-sql-to-azure-2/index.md",title:"Migracja bazy SQL do Azure - Migration database SQL to Azure",description:"Migracja bazy Microsoft SQL do Azure SQL krok po kroku.",date:"2013-08-14T00:00:00.000Z",formattedDate:"August 14, 2013",tags:[{label:"azure",permalink:"/tags/azure"},{label:"codeplex",permalink:"/tags/codeplex"},{label:"database",permalink:"/tags/database"},{label:"migration",permalink:"/tags/migration"},{label:"sql",permalink:"/tags/sql"},{label:"sql-services",permalink:"/tags/sql-services"}],readingTime:2.74,truncated:!0,authors:[{name:"Piotr Rogala",title:"MVP Azure & owner JustCloud.pl",url:"https://github.com/RogalaPiotr",imageURL:"https://avatars.githubusercontent.com/u/31566956?v=4",key:"progala"}],frontMatter:{slug:"migration-database-sql-to-azure-2",title:"Migracja bazy SQL do Azure - Migration database SQL to Azure",description:"Migracja bazy Microsoft SQL do Azure SQL krok po kroku.",authors:["progala"],date:"2013-08-14",tags:["azure","codeplex","database","migration","sql","sql-services"],keywords:["azure","codeplex","database","migration","sql","sql-services"],hide_table_of_contents:!0},prevItem:{title:"Pierwsze testy nowej cloud-owej platformy. The first tests of the new cloud platform.",permalink:"/test-platformy-cloud"},nextItem:{title:"Microsoft Azure",permalink:"/microsoft-azure"}},z={authorsImageUrls:[void 0]},u=[],l={toc:u};function m(e){var a=e.components,s=(0,o.Z)(e,n);return(0,i.kt)("wrapper",(0,r.Z)({},l,s,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Migracja bazy SQL do chmury Azure jest prostym procesem, aby go dokona\u0107 bez wi\u0119kszych problem\xf3w nale\u017cy zrozumie\u0107 jak to dzia\u0142a. CODEPLEX udost\u0119pnia programik to migracji bazy SQL bezpo\u015brednio z serwera bazodanowego w chmur\u0119. Brzmi prosto prawda? Pomimo tego warto wspomnie\u0107 o pewnych wymaganiach jakie stawiane s\u0105 przez Azure. Po pierwsze: omawiamy kwestie w kt\xf3rej korzystamy z Cloud Services - gdzie baza SQL stoi na zdefiniowanej przez nas instancji - wybieramy w jakim rejonie \u015bwiata znajduje si\u0119 serwer oraz moc instancji. Po drugie: aby tego dokona\u0107 musimy sobie zda\u0107 spraw\u0119, \u017ce mamy ograniczony dost\u0119p do ustawie\u0144 bazy. Cloud Services cechuje si\u0119 tym, \u017ce korzystamy interfejsu Azure-owego do zarz\u0105dzania baz\u0105 lub \u0142\u0105czymy si\u0119 z serwerem przez Management Studio gdzie otrzymujemy okrojone mo\u017cliwo\u015bci o kt\xf3rych wspomn\u0119 w dalszej cz\u0119\u015bci. G\u0142\xf3wnym problem jest to \u017ce nie mo\u017cemy w prosty spos\xf3b u\u017cy\u0107 funkcji przywr\xf3cenia bazy SQL z pliku .bak poniewa\u017c nie mamy takiej opcji. Jedyna mo\u017cliwo\u015b\u0107 to deploy bazy z pliku .bacpac. Dlatego aby dokona\u0107 migracji bazy z \u015brodowiska produkcyjnego potrzebujemy narz\u0119dzia SQL Database Migration Wizard: ",(0,i.kt)("a",{parentName:"p",href:"http://sqlazuremw.codeplex.com/",title:"http://sqlazuremw.codeplex.com/"},"sqlazuremw.codeplex.com"),". Zanim jeszcze rozpoczniemy prac\u0119 z programem nale\u017cy zdefiniowa\u0107 dost\u0119p z jakiego adresu IP b\u0119dziemy dokonywa\u0107 migracji, wygl\u0105da to tak:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_012_06082013_161238.jpg",src:t(4369).Z,width:"926",height:"1024"})),(0,i.kt)("p",null,"Powy\u017csza ilustracja obrazuje jak wygl\u0105da zdefiniowany scope IP dost\u0119powy dla naszej instancji SQL. Po dokonaniu tej czynno\u015bci przechodzimy do narz\u0119dzia CODEPLEX-a (warto go uruchomi\u0107 jako administrator):"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_001_06082013_105051.jpg",src:t(3379).Z,width:"600",height:"630"})),(0,i.kt)("p",null,"Po uruchomieniu wybieramy Migrate Database, przechodz\u0105c dalej wybieramy po\u0142\u0105czenia si\u0119 z nasz\u0105 baz\u0105 lokaln\u0105, kt\xf3r\u0105 chcemy migrowa\u0107. W kolejnych krokach wybieramy baz\u0119 z z serwera SQL i generujemy dla niej skrypt, kt\xf3ry b\u0119dzie interpretowany w chmurze Azure w celu jej importu. Klikamy dalej aby generowa\u0107 kod."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_015_07082013_101605.jpg",src:t(4581).Z,width:"600",height:"630"})),(0,i.kt)("p",null,"Wygenerowany kod mo\u017cemy zapisa\u0107, ale nie jest to wymagane. Warto przejrze\u0107 powy\u017csze okienko czy nie pojawi\u0142y si\u0119 b\u0142\u0119dy podczas generowania skryptu. Po weryfikacji proponuj\u0119 r\xf3wnie\u017c zajrze\u0107 na dysk C: do katalogu SQLAzureMW. Znajdziemy w nim pliki wygenerowane, kt\xf3re b\u0119d\u0105 eksportowane do naszej chmury w nast\u0119pnych krokach."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_014_06082013_162200.jpg",src:t(2623).Z,width:"566",height:"349"})),(0,i.kt)("p",null,"Wr\xf3\u0107my zatem do migracji, po\u0142\u0105czmy si\u0119 z nasz\u0105 baz\u0105 w Azure. Aby zalogowa\u0107 si\u0119 do bazy podajesz utworzone wcze\u015bniej dane, a nazw\u0119 serwera znajdziesz a panelu Azure."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_010_06082013_161123.jpg",src:t(1805).Z,width:"360",height:"432"})),(0,i.kt)("p",null,"W nast\u0119pnych krokach zaznaczasz baz\u0119 do kt\xf3rej chcesz importowa\u0107 baz\u0119, mo\u017cesz r\xf3wnie\u017c poziomu wizard-a utworzy\u0107 now\u0105 baz\u0119 w Azure. W zale\u017cno\u015bci od wielko\u015bci bazy i przepustowo\u015bci Twojego \u0142\u0105cza b\u0119dzie trwa\u0107 migracja bazy. W moim przypadku baza mia\u0142o ko\u0142o 3gb i trwa\u0142o oko\u0142o 2h. Na marginesie nie wiem czemu w Result Summary mam podany czas 11 minut, ale mo\u017ce to zwi\u0105zane jest z tym \u017ce czas podany dotyczy\u0142 danego procesu kopiowania. Najwa\u017cniejsze jest aby migrator przeni\xf3s\u0142 wszystkie elementy bez error-\xf3w."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_009_06082013_111552.jpg",src:t(1210).Z,width:"612",height:"652"})),(0,i.kt)("p",null,"Na koniec proponuj\u0119 pod\u0142\u0105czy\u0107 si\u0119 do bazy przez Management Studio i zweryfikowa\u0107 wielko\u015b\u0107 bazy po migracji. Mo\u017cesz to zrobi\u0107 nast\u0119puj\u0105cym poleceniem:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"SELECT (SUM(reserved_page_count) * 8192) / 1024 / 1024 AS DbSizeInMB\nFROM sys.dm_db_partition_stats\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"capture_019_07082013_101934.png",src:t(290).Z,width:"953",height:"1024"})),(0,i.kt)("p",null,'Na czerwono zaznaczy\u0142em wielko\u015b\u0107 mojej bazy i teraz mog\u0119 by\u0107 pewny \u017ce baza przeniesiona nie ma \u017cadnych ubytk\xf3w i zosta\u0142a poprawnie przemigrowana. Wy\u017cej zaznaczy\u0142em Task dotycz\u0105cy bazy, mo\u017cna zauwa\u017cy\u0107 \u017ce mamy ograniczenia zwi\u0105zane z modyfikacjami bazy, nie wspomn\u0119 o tym \u017ce w przypadku SQL Services nie mamy nawet funkcji "Properties" dla bazy. Dlatego zanim przemigrujesz baz\u0119 zastan\xf3w si\u0119 czego b\u0119dziesz potrzebowa\u0107. Zawsze pozostaje mo\u017cliwo\u015b\u0107 zakupienia serwera z z SQL, kt\xf3ry daje nam wszystkie mo\u017cliwo\u015bci konfiguracji. W razie pyta\u0144 zapraszam! Mo\u017cesz pisa\u0107 do mnie w komentarzach i na priv, pozdrawiam!'))}m.isMDXComponent=!0},3379:function(e,a,t){a.Z=t.p+"assets/images/capture_001_06082013_105051-d947bacff28651193df2fad01580c2f9.jpg"},1210:function(e,a,t){a.Z=t.p+"assets/images/capture_009_06082013_111552-4a913a49a02e725d8a8f01c324b2c20e.jpg"},1805:function(e,a,t){a.Z=t.p+"assets/images/capture_010_06082013_161123-2d2671262018570b3cda43129ea706bc.jpg"},4369:function(e,a,t){a.Z=t.p+"assets/images/capture_012_06082013_161238-158a3e28b0eeb957bdc6403fd85ab77d.jpg"},2623:function(e,a,t){a.Z=t.p+"assets/images/capture_014_06082013_162200-fe5fda368ebf3c89fdf435feeed75a78.jpg"},4581:function(e,a,t){a.Z=t.p+"assets/images/capture_015_07082013_101605-da0cabb1c0ecd5aa398e04f136b44ffe.jpg"},290:function(e,a,t){a.Z=t.p+"assets/images/capture_019_07082013_101934-d9ad8f6dac109ad30387aa4a5e6c5fb9.png"}}]);